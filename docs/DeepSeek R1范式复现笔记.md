Title: DeepSeek R1èŒƒå¼å¤ç°ç¬”è®°

URL Source: https://mp.weixin.qq.com/s/BYPKP5oXg1V4C_vg0VFGhw

Markdown Content:
ä½œè€…ï¼šyulei

ä¸¨ å¯¼è¯­è‡ªDeepSeek R1æŠ€æœ¯æŠ¥å‘ŠğŸ³å¼€æ”¾ä»¥æ¥ï¼Œå¼€æºç¤¾åŒºæ¶Œç°äº†å¤šç§ã€Œå¤ç°ã€å·¥ä½œã€‚æœ¬R1å¤ç°ç¬”è®°æ—¨åœ¨ä»¥å¤šä¸ªå¼€æºé¡¹ç›®çš„å†å¤ç°ä»¥åŠäº¤å‰éªŒè¯ä¸ºç›®æ ‡ï¼Œæ¢ç´¢R1/R1-zeroä¸­å¼ºåŒ–å­¦ä¹ æ­¥éª¤å¸¦æ¥çš„æ¨¡å‹æ•ˆæœæå‡ï¼Œå¹¶å°è¯•å±•æœ›R1æŠ€æœ¯åœ¨æœªæ¥æ¨¡å‹è®­ç»ƒä¸ä¸šåŠ¡è½åœ°ä¸Šçš„å‰æ™¯

1\. R1 å¼€æºé¡¹ç›®æ¢³ç†
-------------

ç›®å‰ä¸»æµçš„ R1 ç³»åˆ—å¤ç°å·¥ä½œå¦‚è¡¨ 1 æ‰€ç¤ºã€‚ç»¼åˆè€ƒè™‘æ•°æ®é¢†åŸŸï¼ˆæ•°å­¦é¢˜ã€é€»è¾‘é¢˜ç­‰ï¼‰åŠæ¡†æ¶ï¼Œæˆ‘ä»¬é€‰å–äº† SimpleRLã€OpenR1ã€LogitRLã€TinyZero è¿™å››ä¸ªé¡¹ç›®å¼€å±•ç±» R1 è®­ç»ƒèŒƒå¼çš„å®éªŒã€‚

è¡¨ 1 ä¸»æµå¼€æº R1 å¤ç°å·¥ä½œ

| Github | è®­ç»ƒé›† | æµ‹è¯•é›† | æ¨¡å‹ | RL æ¡†æ¶ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ˜“ä¸Šæ‰‹è¯„çº§ |
| --- | --- | --- | --- | --- | --- | --- | --- |
| [simpleRL-reason](https://github.com/hkust-nlp/simpleRL-reason) | MATH 8K(level 3-5) | AIME 2024  
MATH 500  
AMCMinerva Math
OlympiadBench

 | Qwen2.5-7B | OpenRLHF | 1ï¼‰å®ç°ç®€å•  
2ï¼‰ç³»ç»Ÿå·¥ä½œæ”¯æŒ PRM/ORM/R1 ç­‰  
3ï¼‰RL æ¡†æ¶æ”¯æŒå¤šæœºå¤šå¡ | 1ï¼‰RL ç®—æ³•æš‚ä¸æ”¯æŒ GRPO | â­ï¸â­ï¸â­ï¸ |
| [open-r1](https://github.com/huggingface/open-r1) | DigitalLearningGmbH/MATH-lighteval  
AI-MO/NuminaMath-TIR | AIME 2024  
MATH-500  
GPQA Diamond | DeepSeek-R1-Distill-Qwen-7B  
Qwen2.5-Math-7B  
Qwen2.5-1.5B-Instruct | TRL | 1ï¼‰å®ç°ç®€å•  
2ï¼‰å…¨æµç¨‹æ”¯æŒ R1 ç³»åˆ—å·¥ä½œï¼ˆsft/rl/sft+rlï¼‰ | 1ï¼‰å¤šæœºè®­ç»ƒæš‚ä¸æ”¯æŒ | â­ï¸â­ï¸ |
| [unsloth](https://github.com/unsloth) | GSM8K | GSM8K\[test\] | LLAMA 3.1(8B)  
Phi4  
Qwen2.5-1.5B | TRL | 1ï¼‰å®˜æ–¹å£°ç§°æœ€æ¥è¿‘ R1 çš„å¤ç°æ–¹å¼  
2ï¼‰æ¥å£ç®€å• | 1ï¼‰å¤šå¡éœ€ä»˜è´¹ | â­ï¸ |
| [logit-RL](https://github.com/Unakar/Logic-RL) | KK è€å®äººä¸éª—å­ lv3&5 | KK è€å®äººä¸éª—å­ | Qwen2.5-7B-Instruct | veRL | 1ï¼‰RL æ¡†æ¶æ”¯æŒå¤šç§ç®—æ³•  
2ï¼‰å¤ç°ç‡è¾ƒé«˜ | 1ï¼‰å¤šæœºè®­ç»ƒæš‚ä¸æ”¯æŒ | â­ï¸â­ï¸â­ï¸ |
| [tinyzero](https://github.com/Jiayi-Pan/TinyZero) | Countdown | Countdown | Qwen2.5-3B | veRL | 1ï¼‰RL æ¡†æ¶æ”¯æŒå¤šç§ç®—æ³•  
2ï¼‰å¤ç°ç‡è¾ƒé«˜ | 1ï¼‰å¤šæœºè®­ç»ƒæš‚ä¸æ”¯æŒ | â­ï¸â­ï¸â­ï¸ |
| [oatzero](https://github.com/oatzero) | 8K MATH | MATH 500 | Qwen2.5-Math-7B/1.5B  
Qwen2.5-7B/3B  
Microsoft-Rho-Math-7B  
DeepSeek-Math-7B-Base | OAT | 1ï¼‰ç»Ÿä¸€é›†æˆäº† tinyzero ç­‰ä»£ç  | 1ï¼‰å¤šæœºè®­ç»ƒæš‚ä¸æ”¯æŒ | â­ï¸â­ï¸ |
| [demystify](https://github.com/eddycmu/demystify-long-cot) | MATH | WebInstruct  
MATH-500  
TheoremQA  
MMLU-Pro-1k | Llama3.1-8B  
Qwen2.5-Math-7B | OpenRLHF | 1ï¼‰å®ç°ç®€å•  
2ï¼‰è®ºæ–‡æœ¬èº«è¾ƒæ‰å®ï¼ˆè®­ç»ƒ & éªŒè¯å……åˆ†ï¼‰ | 1ï¼‰å®éªŒ setting ä¸ R1 ç¨æœ‰åŒºåˆ« | â­ï¸â­ï¸ |

2\. å®éªŒè®¾ç½®
--------

### 2.1 è®­ç»ƒæ•°æ®

**æ•°å­¦é¢˜**

*   **SimpleRL**
    

*   æ•°æ®é›†ï¼šMATH8K [simpleRL-reason/train/data/math\_level3to5\_data\_processed\_with\_qwen\_prompt.json at main Â· hkust-nlp/simpleRL-reason Â· GitHub](https://github.com/hkust-nlp/simpleRL-reason/blob/main/train/data/math_level3to5_data_processed_with_qwen_prompt.json)
    
*   æ•°æ®é‡ï¼š8.5K
    
*   æ¥æºï¼šMATH æ•°æ®é›†ä¸­éš¾åº¦åœ¨ 3-5 ç­‰çº§çš„é¢˜ç›®
    

*   **OpenR1**
    

*   æ•°æ®é›†ï¼šMATH-lighteval [https://huggingface.co/datasets/DigitalLearningGmbH/MATH-lighteval](https://huggingface.co/datasets/DigitalLearningGmbH/MATH-lighteval)
    
*   æ•°æ®é‡ï¼š7.5K
    
*   æ¥æºï¼šä»¥ lighteval å½¢å¼é‡ç»„çš„ MATH æ•°æ®é›†ï¼ŒåŒ…å«åˆ†æ­¥éª¤çš„é¢˜è§£
    
*   æ•°æ®é›†ï¼šMATH-numina [https://huggingface.co/datasets/AI-MO/NuminaMath-TIR](https://huggingface.co/datasets/AI-MO/NuminaMath-TIR)
    
*   æ•°æ®é‡ï¼š72.4K
    
*   æ¥æºï¼šNuminaMath-CoT ä¸­çš„é¢˜ç›®ï¼Œä½¿ç”¨ tool-integrated reasoning æ–¹å¼è·å¾— GPT4o çš„æ¨ç†é“¾è·¯ï¼ˆåŒ…å« python è§£æ³•ã€ä»£ç æ‰§è¡Œè¿‡ç¨‹ç­‰å¤šè½®äº¤äº’ï¼‰
    

*   **TinyZero**
    

*   æ•°æ®é›†ï¼šCountdownï¼ˆåŠ å‡ä¹˜é™¤è‡³ç›®æ ‡æ•°å­—ï¼‰[https://huggingface.co/datasets/Jiayi-Pan/Countdown-Tasks-3to4](https://huggingface.co/datasets/Jiayi-Pan/Countdown-Tasks-3to4)
    
*   æ•°æ®é‡ï¼š490K
    
*   æ¥æºï¼šç»å…¸æ¸¸æˆï¼Œä½¿ç”¨è¿ç®—ç¬¦å°†ç»™å®šçš„ 3 ä½æ•°å­—ã€4 ä½æ•°å­—è®¡ç®—å¾—åˆ°ç›®æ ‡å€¼
    

**é€»è¾‘é¢˜**

*   **LogicRL**
    

*   æ•°æ®é›†ï¼šKnights and Knavesï¼ˆè€å®äººä¸éª—å­ï¼‰[https://huggingface.co/datasets/K-and-K/knights-and-knaves](https://huggingface.co/datasets/K-and-K/knights-and-knaves)
    
*   æ•°æ®é‡ï¼š3PPLï¼ˆä¸‰äººï¼‰1Kï¼›5PPLï¼ˆäº”äººï¼‰1K
    
*   æ¥æºï¼šé€»è¾‘é¢˜ï¼Œè€å®äººåªè¯´çœŸè¯ï¼›éª—å­æ€»è¯´å‡è¯ã€‚æ‰¾å‡ºæ‰€æœ‰çš„è€å®äººä¸éª—å­ã€‚
    

### 2.2 åŸºåº§æ¨¡å‹é€‰å–

è€ƒè™‘åˆ°å¯å¤ç°æ€§ï¼ˆå¯¹é½å¼€æºé¡¹ç›®ï¼‰ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä»¥ä¸‹åŸºåº§æ¨¡å‹ï¼š

*   Qwen2.5-7B-Mathï¼ˆBaseï¼‰ï¼šSimpleRLã€OpenR1
    
*   Qwen2.5-1.5B-Instructï¼šOpenR1
    
*   Deepseek-R1-Distill-Qwen-7Bï¼ˆInstructï¼‰ï¼šOpenR1
    
*   Qwen2.5-3Bï¼ˆBaseï¼‰ï¼šTinyZero
    
*   Qwen2.5-7Bï¼ˆBaseï¼‰ï¼šLogicRLã€TinyZero
    
*   Qwen2.5-7B-Instructï¼šLogicRL
    

Qwen-Math ç³»åˆ—çš„åŸºåº§æ¨¡å‹åœ¨ RL å‰å°±å·²ç»å…·å¤‡äº†è§£å†³å¤šç§éš¾åº¦æ•°å­¦é¢˜çš„èƒ½åŠ›ï¼Œè¿™ä¸ºåç»­æ¿€å‘æ¨¡å‹æ…¢æ€è€ƒçš„ long CoT èƒ½åŠ›æ‰“ä¸‹äº†åšå®çš„åŸºç¡€ã€‚

å—åˆ°è®¡ç®—èµ„æºçš„å½±å“ä»¥åŠç°åœ¨å¼€æºçš„å„ç±» RL æ¡†æ¶çš„é™åˆ¶ï¼Œå¤§éƒ¨åˆ†å¼€æºå·¥ä½œéƒ½å°†æ¨¡å‹å°ºå¯¸é™åˆ¶åœ¨äº† 1.5B è‡³ 7B çš„é‡çº§ã€‚ä¸€æ–¹é¢ï¼Œå°æ¨¡å‹èƒ½å¤Ÿæ–¹ä¾¿æˆ‘ä»¬å¿«é€Ÿä¸Šæ‰‹ R1 çš„å¤ç°å·¥ä½œï¼›ä½†å¦ä¸€æ–¹é¢ï¼Œå°æ¨¡å‹æœ¬èº«çš„é€»è¾‘æ¨ç†èƒ½åŠ›æœ‰é™ï¼Œè¿™é™åˆ¶äº†æ›´å…¨é¢ã€å®ç”¨çº§åˆ«ï¼ˆè€Œé toy-studyï¼‰ç±» R1 å·¥ä½œçš„å¤ç°ã€‚å› æ­¤ï¼Œåœ¨åç»­çš„å·¥ä½œä¸­ï¼Œé’ˆå¯¹ RL æ¡†æ¶çš„ä¼˜åŒ–ï¼ˆå¤šæœºå¤šå¡è®­ç»ƒã€å‡å°‘è®­ç»ƒä¸­ rollout ç­‰æ­¥éª¤å¯¼è‡´çš„æ°”æ³¡ç­‰ï¼‰æ˜¯é€šå¾€å¤§è§„æ¨¡è®­ç»ƒç±» R1 æ¨¡å‹ä¹‹è·¯ä¸Šå¿…é¡»è¦è§£å†³çš„é—®é¢˜ã€‚

### 2.3 RL åŸºæœ¬è®¾ç½®

#### 2.3.1 Reward å‡½æ•°å®šä¹‰

**Format Reward**

RL è®­ç»ƒæ—¶è®¾ç½®ä¸¥æ ¼çš„æ ¼å¼çº¦æŸï¼Œé€šå¸¸ä»¥ system prompt çš„å½¢å¼å‡ºç°åœ¨è®­ç»ƒæ•°æ®ä¸­ã€‚

*   **SimpleRL**
    

*   system prompt
    
    ```
    PleaseÂ reasonÂ stepÂ byÂ step,Â andÂ putÂ yourÂ finalÂ answerÂ withinÂ \boxed{}.  
    ```
    
*   reward å‡½æ•°[å®šä¹‰](https://github.com/hkust-nlp/simpleRL-reason/blob/main/train/openrlhf/trainer/ppo_utils/experience_maker.py#L617) (snippetï¼‰
    
    ```
    ifÂ "boxed"Â notÂ inÂ model_output:  
    box_matchÂ =Â -1.0  
    ```
    

*   **OpenR1**
    

*   system prompt
    
    ```
    AÂ conversationÂ betweenÂ UserÂ andÂ Assistant.Â TheÂ userÂ asksÂ aÂ question,Â andÂ theÂ AssistantÂ solvesÂ it.Â TheÂ assistantÂ firstÂ thinksÂ aboutÂ theÂ reasoningÂ processÂ inÂ theÂ mindÂ andÂ thenÂ providesÂ theÂ userÂ withÂ theÂ answer.Â TheÂ reasoningÂ processÂ andÂ answerÂ areÂ enclosedÂ withinÂ <think>Â </think>Â andÂ <answer>Â </answer>Â tags,Â respectively,Â i.e.,Â <think>Â reasoningÂ processÂ hereÂ </think><answer>Â answerÂ hereÂ </answer>  
    ```
    
*   reward å‡½æ•°[å®šä¹‰](https://github.com/huggingface/open-r1/blob/main/src/open_r1/rewards.py#L52)(snippet)
    
    ```
    defÂ format_reward(completions,Â **kwargs):  
    Â Â Â Â """RewardÂ functionÂ thatÂ checksÂ ifÂ theÂ completionÂ hasÂ aÂ specificÂ format."""  
    Â Â Â Â patternÂ =Â r"^<think>.*?</think>\s*<answer>.*?</answer>$"  
    Â Â Â Â completion_contentsÂ =Â [completion[0]["content"]Â forÂ completionÂ inÂ completions]  
    Â Â Â Â matchesÂ =Â [re.match(pattern,Â content,Â re.DOTALLÂ |Â re.MULTILINE)Â forÂ contentÂ inÂ completion_contents]  
    Â Â Â Â returnÂ [1.0Â ifÂ matchÂ elseÂ 0.0Â forÂ matchÂ inÂ matches]  
    ```
    

*   **LogicRL**
    

*   system promptï¼ˆBaseï¼‰
    
    ```
    TheÂ userÂ asksÂ aÂ question,Â andÂ theÂ AssistantÂ solvesÂ it.TheÂ assistantÂ firstÂ thinksÂ aboutÂ theÂ reasoningÂ processÂ inÂ theÂ mindÂ andÂ thenÂ providesÂ theÂ userÂ withÂ theÂ finalÂ answer.Â TheÂ reasoningÂ processÂ andÂ answerÂ areÂ enclosedÂ withinÂ <think>Â </think>Â andÂ <answer>Â </answer>Â tags,Â respectively,Â i.e.,Â <think>Â reasoningÂ processÂ hereÂ </think><answer>Â answerÂ hereÂ </answer>.Â NowÂ theÂ userÂ asksÂ youÂ toÂ solveÂ aÂ logicalÂ reasoningÂ problem.Â AfterÂ thinking,Â whenÂ youÂ finallyÂ reachÂ aÂ conclusion,Â clearlyÂ stateÂ theÂ identityÂ ofÂ eachÂ characterÂ withinÂ <answer>Â </answer>Â tags.Â ListÂ theÂ identityÂ ofÂ eachÂ personÂ oneÂ byÂ one,Â forÂ example,Â <answer>Â (1)Â ZoeyÂ isÂ aÂ knight\n(2)Â OliverÂ isÂ aÂ knight\n(3)...Â </answer>.  
    ```
    
*   system promptï¼ˆInstructï¼‰
    
    ```
    YouÂ areÂ aÂ helpfulÂ assistant.Â TheÂ assistantÂ firstÂ thinksÂ aboutÂ theÂ reasoningÂ processÂ inÂ theÂ mindÂ andÂ thenÂ providesÂ theÂ userÂ withÂ theÂ answer.Â TheÂ reasoningÂ processÂ andÂ answerÂ areÂ enclosedÂ withinÂ <think>Â </think>Â and<answer>Â </answer>Â tags,Â respectively,Â i.e.,Â <think>Â reasoningÂ processÂ hereÂ </think><answer>Â answerÂ hereÂ </answer>.Â Â NowÂ theÂ userÂ asksÂ youÂ toÂ solveÂ aÂ logicalÂ reasoningÂ problem.Â AfterÂ thinking,Â whenÂ youÂ finallyÂ reachÂ aÂ conclusion,Â clearlyÂ stateÂ theÂ identityÂ ofÂ eachÂ characterÂ withinÂ <answer>Â </answer>Â tags.Â i.e.,Â <answer>Â (1)Â ZoeyÂ isÂ aÂ knight  
    (2)Â ...Â </answer>.  
    ```
    
*   reward å‡½æ•°[å®šä¹‰](https://github.com/Unakar/Logic-RL/blob/086373176ac198c97277ff50f4b6e7e1bfe669d3/verl/utils/reward_score/kk.py#L23)(snippet)
    
    ```
    answer_scoreÂ =Â 0  
    ifÂ format_correctÂ andÂ answer_text:  
    Â Â pred_statusÂ =Â parse_model_answer(answer_text,Â expected_names)  
    Â Â Â Â ifÂ pred_status:  
    Â Â Â Â Â Â Â Â ifÂ pred_statusÂ ==Â gt_status:  
    Â Â Â Â Â Â Â Â Â Â Â Â answer_scoreÂ =Â 2  
    Â Â Â Â Â Â Â Â Â Â Â Â print("Â Â ContentÂ validation:Â FULLÂ MATCH")  
    Â Â Â Â Â Â Â Â else:  
    Â Â Â Â Â Â Â Â Â Â Â Â answer_scoreÂ =Â -1.5  
    Â Â Â Â Â Â Â Â Â Â Â Â print("Â Â ContentÂ validation:Â MISMATCH")  
    Â Â Â Â else:  
    Â Â Â Â Â Â Â Â answer_scoreÂ =Â -2  
    Â Â Â Â Â Â Â Â print(Â "FailÂ toÂ parseÂ answer")  
    else:  
    Â Â Â Â answer_scoreÂ =Â -2  
    Â Â Â Â print("\n[ContentÂ Validation]Â SkippedÂ dueÂ toÂ formatÂ errorsÂ orÂ missingÂ answer")  
    ```
    

*   **TinyZero**
    

*   system promptï¼ˆsnippetï¼‰
    
    ```
    ShowÂ yourÂ workÂ inÂ <think>Â </think>Â tags.Â AndÂ returnÂ theÂ finalÂ answerÂ inÂ <answer>Â </answer>Â tags,Â forÂ exampleÂ <answer>Â (1Â +Â 2)Â /Â 3Â </answer>.  
    ```
    
*   reward å‡½æ•°[å®šä¹‰](https://github.com/Jiayi-Pan/TinyZero/blob/8a623926012ff785f2dc6f3639a821465eed07c4/verl/utils/reward_score/countdown.py#L18)(snippet)
    
    ```
    answer_patternÂ =Â r'<answer>(.*?)</answer>'  
    matchÂ =Â re.finditer(answer_pattern,Â solution_str)  
    matchesÂ =Â list(match)  
    ifÂ matches:  
    Â Â Â Â final_answerÂ =Â matches[-1].group(1).strip()  
    else:  
    Â Â Â Â final_answerÂ =Â None  
    returnÂ final_answer  
    ```
    

**Accuracy Reward**

è€ƒè™‘åˆ°ç­”æ¡ˆæ ¡éªŒå­˜åœ¨ä¸åŒçš„ç±»å‹ï¼ˆå­—ç¬¦ä¸²é€šå¸¸ä½¿ç”¨ exact\_matchï¼Œæµ®ç‚¹æ•°å…è®¸ç»™å®šç²¾åº¦ä¸‹çš„è¯¯å·®ï¼‰ï¼Œä¸åŒå¼€æºé¡¹ç›®ä¹Ÿä½¿ç”¨äº†é€‚åº”äºè®­ç»ƒé›†çš„ç­”æ¡ˆæ ¡éªŒå‡½æ•°ã€‚

*   **SimpleRL**
    

*   accuracy reward [å®šä¹‰](https://github.com/hkust-nlp/simpleRL-reason/blob/main/train/openrlhf/trainer/ppo_utils/experience_maker.py#L551)(snippet)
    
    ```
    ifÂ qwen_math_equal_subprocess(prediction=extract_answer,Â reference=answer):  
    Â Â Â Â box_matchÂ =Â 1.0  
    else:  
    Â Â Â Â box_matchÂ =Â -0.5  
    ```
    

*   **OpenR1**
    

*   accuracy reward [å®šä¹‰](https://github.com/huggingface/open-r1/blob/main/src/open_r1/rewards.py#L10)(snippet)
    
    ```
    #Â RewardÂ 1Â ifÂ theÂ contentÂ isÂ theÂ sameÂ asÂ theÂ groundÂ truth,Â 0Â otherwise  
    rewardÂ =Â float(verify(answer_parsed,Â gold_parsed))  
    ```
    

*   **LogicRL**
    

*   accuracy reward [å®šä¹‰](https://github.com/Unakar/Logic-RL/blob/086373176ac198c97277ff50f4b6e7e1bfe669d3/verl/utils/reward_score/kk.py#L141)(snippet)
    
    ```
    answer_scoreÂ =Â 0  
    ifÂ format_correctÂ andÂ answer_text:  
    Â Â Â Â pred_statusÂ =Â parse_model_answer(answer_text,Â expected_names)  
    Â Â Â Â ifÂ pred_status:  
    Â Â Â Â Â Â Â Â ifÂ pred_statusÂ ==Â gt_status:  
    Â Â Â Â Â Â Â Â Â Â Â Â answer_scoreÂ =Â 2  
    Â Â Â Â Â Â Â Â Â Â Â Â print("Â Â ContentÂ validation:Â FULLÂ MATCH")  
    Â Â Â Â Â Â Â Â else:  
    Â Â Â Â Â Â Â Â Â Â Â Â answer_scoreÂ =Â -1.5  
    Â Â Â Â Â Â Â Â Â Â Â Â print("Â Â ContentÂ validation:Â MISMATCH")  
    Â Â Â Â else:  
    Â Â Â Â Â Â Â Â answer_scoreÂ =Â -2  
    Â Â Â Â Â Â Â Â print(Â "FailÂ toÂ parseÂ answer")  
    else:  
    Â Â Â Â answer_scoreÂ =Â -2  
    Â Â Â Â print("\n[ContentÂ Validation]Â SkippedÂ dueÂ toÂ formatÂ errorsÂ orÂ missingÂ answer")  
    ```
    

*   **TinyZero**
    

*   accuracy reward [å®šä¹‰](https://github.com/Jiayi-Pan/TinyZero/blob/8a623926012ff785f2dc6f3639a821465eed07c4/verl/utils/reward_score/countdown.py#L59)(snippet)
    
    ```
    #Â EvaluateÂ equation  
    try:  
    Â Â Â Â resultÂ =Â evaluate_equation(equation)  
    Â Â Â Â ifÂ resultÂ isÂ None:  
    Â Â Â Â Â Â Â Â ifÂ do_print:  
    Â Â Â Â Â Â Â Â Â Â Â Â print(f"CouldÂ notÂ evaluateÂ equation")  
    Â Â Â Â Â Â Â Â returnÂ format_score  
    Â Â Â Â ifÂ abs(resultÂ -Â target)Â <Â 1e-5:Â Â #Â AccountÂ forÂ floatingÂ pointÂ precision  
    Â Â Â Â Â Â Â Â ifÂ do_print:  
    Â Â Â Â Â Â Â Â Â Â Â Â print(f"CorrectÂ equation:Â {equation}Â =Â {result}")  
    Â Â Â Â Â Â Â Â returnÂ score  
    Â Â Â Â else:  
    Â Â Â Â Â Â Â Â ifÂ do_print:  
    Â Â Â Â Â Â Â Â Â Â Â Â print(f"WrongÂ result:Â equationÂ =Â {result},Â targetÂ =Â {target}")  
    Â Â Â Â Â Â Â Â returnÂ format_score  
    ......  
    ```
    

**å°ç»“** ï¼šDeepSeek R1 çš„ format çº¦æŸä¸»è¦ä»¥ "{think process}{answer}" çš„å½¢å¼å®ç°ï¼Œè€Œå¼€æºæ–¹æ¡ˆå¤§å¤šé‡‡ç”¨äº† "{think process}{answer}" çš„å½¢å¼ã€‚ä»ä¼˜åŒ–è§’åº¦è€Œè¨€ä¸¤è€…çš„å·®å¼‚ä¸å¤§ã€‚åœ¨æ„å»ºåŸºäºæ­£åˆ™è¡¨è¾¾å¼æ¥åˆ¤æ–­æ¨¡å‹è¾“å‡ºæ˜¯å¦å­˜åœ¨è§„èŒƒæ ¼å¼æ—¶ï¼Œå¾€å¾€é‡‡ç”¨çš„æ˜¯è¾ƒä¸ºä¸¥æ ¼çš„ r"^._?\\s_.\*?$" æ¥çº¦æŸå¼€å¤´ä¸ç»“å°¾ã€‚é’ˆå¯¹éƒ¨åˆ†æ•°å­¦ç±»é—®é¢˜ï¼Œformat reward è€ƒè™‘ç­”æ¡ˆæ˜¯å¦å‡ºç°äº† \\box{} æ¡†ã€‚

è‡³äº accuracy rewardï¼Œå„ä¸ªå·¥ä½œçš„å®ç°æ–¹å¼åŸºæœ¬æ²¿ç”¨äº†è¿‡å¾€å¼ºåŒ–å­¦ä¹ ç®—æ³•ä¸­ ORM é‡Œçš„ä»£ç ã€‚æ­¤å¤„çš„éš¾ç‚¹æœ‰ä¸¤ä¸ªï¼š1ï¼‰éœ€è¦ç¼–å†™å¤§é‡çš„åå¤„ç†ä»£ç ï¼Œä»æ¨¡å‹çš„è¾“å‡ºç»“æœä¸­èƒ½å¤ŸæˆåŠŸè§£æå‡ºæœ€ç»ˆçš„ç»“æœï¼›2ï¼‰éœ€è¦è€ƒè™‘åˆ¤æ–­ç›¸ç­‰çš„æ¡ä»¶ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ç­‰ï¼‰ï¼Œå¹¶é’ˆå¯¹ä¸åŒçš„é¢†åŸŸæ•°æ®è®¾è®¡ä¸åŒçš„ reward æ–¹å¼ã€‚å¯¹äºå‰è€…è€Œè¨€ï¼Œå¯¹äºæŸäº›è¦æ±‚æ ¼å¼åŒ–è¾“å‡ºç±»é—®é¢˜ï¼Œéœ€è¦æ­£ç¡®åŒ¹é…å‡ºç›®æ ‡ kv å¯¹ã€‚å¯¹äºåè€…è€Œè¨€ï¼Œåˆ¤æ–­ prediction å’Œ gt æ˜¯å¦ç›¸ç­‰å¹¶è¿”å› reward çš„å®šä¹‰ä¹Ÿæœ‰æ‰€è®²ç©¶ã€‚æœ€ä¸¥æ ¼çš„å®Œå…¨ä¸€è‡´åŒ¹é…åªä¼šåŒºåˆ†æ­£ç¡® - é”™è¯¯ä¸¤ç§æƒ…å†µï¼Œåœ¨æŸäº›ä»»åŠ¡ä¸Šå¯èƒ½ä¼šå½±å“è®­ç»ƒæ”¶æ•›çš„é€Ÿåº¦ã€‚

#### 2.3.2 Penalty å‡½æ•°å®šä¹‰ (Optional)

å¤§å¤šæ•°å¼€æºé¡¹ç›®ä¸­å¹¶æ²¡æœ‰å¼ºè°ƒ penalty åŠå…¶å®ç°ï¼Œä½†ç›®å‰çš„æœ€æ–°æ–‡ç« æŒ‡å‡ºäº†é‡å¤ penalty ä¸é•¿åº¦ penalty çš„é‡è¦æ€§ã€‚æ–½åŠ åŸºäº repetition çš„ penalty å‡½æ•°å¯ä»¥å‡å°‘ CoT ä¸­è½¦è½±è¾˜è¯çš„å†…å®¹ã€‚å…·ä½“åœ°ï¼Œrepetition penalty æ˜¯åŸºäº n-gram å®ç°çš„ï¼Œç»´æŠ¤ä¸€ä¸ªå·²ç»è®¿é—®è¿‡çš„ n-gram é›†åˆï¼Œå¹¶ä»¥ n ä¸ºæ»‘åŠ¨çª—å£çš„å¤§å°ã€‚ä»å‰åˆ°åæ»‘åŠ¨åˆ¤æ–­æ˜¯å¦å¤šæ¬¡å‡ºç°äº†ç›¸åŒçš„ n-gramï¼Œå¹¶ä»¥æ­¤ä¸ºæƒ©ç½šã€‚å®ç°[å‚è€ƒ](https://github.com/eddycmu/demystify-long-cot/blob/release/openrlhf/openrlhf/reward/repetition.py#L10)(snippet)ï¼š

```
ngramsÂ =Â set()  
totalÂ =Â 0  
forÂ ngÂ inÂ zipngram(generation,Â ngram_size):  
Â Â Â Â ngrams.add(ng)  
Â Â Â Â totalÂ +=Â 1  
scalingÂ =Â 1Â -Â len(ngrams)Â /Â total  
returnÂ scalingÂ *Â max_penalty  
```

é’ˆå¯¹ä¸¤ä¸ªæ­£ç¡®çš„ç­”æ¡ˆ A ä¸ç­”æ¡ˆ Bï¼Œå¦‚æœç­”æ¡ˆ A çš„é•¿åº¦å°äºç­”æ¡ˆ B çš„é•¿åº¦ï¼Œé‚£ä¹ˆé€šå¸¸ä¼šç»™äºˆç­”æ¡ˆ A æ›´é«˜çš„ reward ä»¥ç²¾ç®€æ€ç»´é“¾ï¼›è€Œé’ˆå¯¹ä¸¤ä¸ªé”™è¯¯çš„ç­”æ¡ˆ A ä¸ç­”æ¡ˆ Bï¼Œå¦‚æœ A çš„é•¿åº¦å°äº B çš„é•¿åº¦ï¼Œåˆ™ä¼šæƒ©ç½š Aï¼Œä»¥é¼“åŠ±æ¨¡å‹è¿›ä¸€æ­¥æ¢ç´¢è§£æ³•æ¥æå‡æ€ç»´é“¾ä¸­çš„åæ€ã€åˆ†å‰ç­‰ã€‚å®é™…è®­ç»ƒæ—¶ï¼Œä¸Šè¿°çš„ penalty è®¾è®¡ä»ç„¶å¯èƒ½å­˜åœ¨æ„æƒ³ä¸åˆ°çš„ hacking æƒ…å†µã€‚æ¯”å¦‚ï¼Œé¼“åŠ±é•¿åº¦æ›´çŸ­çš„æ­£ç¡®å›ç­”å¯èƒ½ç ´åäº†æ¨¡å‹åŸæœ¬çš„ branching æ€è€ƒï¼ˆalternatively...ï¼‰ã€‚å®é™…å¤åˆ» R1 æ—¶ï¼Œè¿˜éœ€è¦è€ƒè™‘ä¸åŒéš¾åº¦çš„æ•°æ®æ··åˆæ¯”ä¾‹ï¼Œé˜²æ­¢ç®€å•é¢˜ç›®å›ç­”å‡æ­£ç¡®æƒ…å†µä¸‹çš„æ€ç»´é“¾é€€åŒ–ã€‚

#### 2.3.3 ä¼˜åŒ–æ–¹å¼

å¼€æºé¡¹ç›®å¤§éƒ¨åˆ†éƒ½æ”¯æŒ PPO ç®—æ³•ã€‚ç›®å‰ TRL å’Œ VeRL åº“å‡å·²æ”¯æŒ GRPO ç®—æ³•ã€‚

*   SimpleRLï¼ˆOpenRLHFï¼‰-\> PPO
    
*   OpenRLï¼ˆTRLï¼‰-\> GRPO
    
*   LogitRLï¼ˆVeRLï¼‰-\> GRPO
    
*   TinyZeroï¼ˆVeRLï¼‰-\> PPO & GRPO
    

#### 2.3.4 è®­ç»ƒå¹³å°

å¤ç°å·¥ä½œå‡åœ¨ TIONE å¹³å°ä¸Šä½¿ç”¨ 1 å° ~ 4 å°Â  GPUs è¿›è¡Œã€‚ä¸Šè¿°å‡ ä¸ªå¼€æºå¤ç°å·¥ä½œä¸­ï¼Œåªæœ‰ OpenRLHF æ”¯æŒå¤šæœºå¤šå¡è®­ç»ƒã€‚å…¶ä½™çš„ä»…æ”¯æŒå•æœºå¤šå¡è®­ç»ƒï¼Œä¸”å¾€å¾€å­˜åœ¨ GPU æ•°ç›®çš„é™åˆ¶ã€‚åœ¨è®­ç»ƒ TinyZero å’Œ LogitRL æ—¶ï¼Œæˆ‘ä»¬å°±é‡åˆ°äº†æ‰©å±• GPUs åè®­ç»ƒå¡åœ¨åˆå§‹åŒ–çš„é—®é¢˜ã€‚

å¤§éƒ¨åˆ†é¡¹ç›®ä½¿ç”¨ 4 å¡ã€8 å¡ã€32 å¡ï¼ˆSimpleRLï¼‰å¤ç°è€—æ—¶åœ¨ 2~3 å¤©å·¦å³ã€‚

3\. å®éªŒç»“æœä¸åˆ†æ
-----------

### 3.1 å¼€æ”¾è®­ç»ƒè¿‡ç¨‹

*   SimpleRL [SimpleRL-å¤ç°ç»“æœ](https://api.wandb.ai/links/yuleiqin-tencent/97xftizo)
    
*   OpenR1[OpenR1å¤ç°ç»“æœ](https://api.wandb.ai/links/yuleiqin-tencent/h10ms0jr)
    
*   LogitRL
    

*   Stage1 [LogicRL-stage1(3ppl)å¤ç°ç»“æœ](https://api.wandb.ai/links/yuleiqin-tencent/h2gp644r)
    
*   Stage2 [LogicRL-Stage2(5ppl)å¤ç°ç»“æœ](https://api.wandb.ai/links/yuleiqin-tencent/svgtxoij)
    
*   Stage3 [LogicRL-Stage3(5ppl)å¤ç°ç»“æœ](https://api.wandb.ai/links/yuleiqin-tencent/wl14j4f5)
    

*   TinyZero
    

*   PPO [TinyZero-R1å¤ç°ç»“æœ](https://api.wandb.ai/links/yuleiqin-tencent/crea6kem)
    
*   GRPO [TinyZero-R1(GRPO)å¤ç°ç»“æœ](https://api.wandb.ai/links/yuleiqin-tencent/3d2dk0bp)
    

### 3.2 ç»“æœè¯¦è¿°

#### 3.2.1 SimpleRL

æˆ‘ä»¬ä½¿ç”¨å¤šæœº 32 å¡è·‘å®Œäº†è®­ç»ƒè¿‡ç¨‹ï¼ˆæ€»æ­¥æ•°ä¸º 160 æ­¥ï¼‰ï¼›åŒæ—¶ä½¿ç”¨å•æœº 8 å¡è®­ç»ƒäº†ä¸€åŠä½œä¸ºå¯¹æ¯”ã€‚æ ¸å¿ƒçš„è®­ç»ƒè¿‡ç¨‹ç¤ºæ„å›¾å¦‚ä¸‹ï¼š

| reward | å›å¤é•¿åº¦ |
| --- | --- |
| ![Image 1: img](assets/5/5/551008aa4b565d452cd12000eb4dbd40.png) | ![Image 2: img](assets/3/3/335a031fb89035a5678ea4b6a60b0ef4.png) |

å›¾ 3.2.1(1) SimpleRL è®­ç»ƒè¿‡ç¨‹ä¸­è®­ç»ƒé›† rewardï¼ˆå·¦ï¼‰ä¸å›å¤é•¿åº¦ï¼ˆå³ï¼‰çš„å˜åŒ–

**ç›¸æ¯”äº SimpleRL åšå®¢ä¸­æ±‡æŠ¥çš„æœ€ç»ˆå›å¤é•¿åº¦è€Œè¨€ï¼Œæˆ‘ä»¬æœ€ç»ˆæ”¶æ•›çš„é•¿åº¦åçŸ­ã€‚**SimpleRL æ±‡æŠ¥çš„æœ€ç»ˆé•¿åº¦å¤§çº¦åœ¨ 700 å·¦å³ï¼Œä½†æˆ‘ä»¬åœ¨ 580 å·¦å³ã€‚è¿™é‡Œçš„å¯èƒ½åŸå› æœ‰ä¸¤ä¸ªï¼š1ï¼‰è®­ç»ƒçš„è¶…å‚æœªå®Œå…¨å¯¹é½å…¶è®¾ç½®ï¼Œåç»­å¾…è¿›ä¸€æ­¥ä¼˜åŒ–è¶…å‚ã€‚2ï¼‰éœ€è¦æ”¹è¿›ç›®å‰çš„ format çº¦æŸï¼Œå¼ºåˆ¶åŒºåˆ† CoT æ€è€ƒé“¾è·¯éƒ¨åˆ†ä¸ç­”æ¡ˆéƒ¨åˆ†ã€‚

**å•æœºå¤šå¡ï¼ˆ8 GPUsï¼‰ä¸å¤šæœºå¤šå¡ï¼ˆ32 GPUsï¼‰è®­ç»ƒçš„æ•ˆæœåŸºæœ¬ä¸€è‡´ï¼Œå¤šæœºè®­ç»ƒé€Ÿåº¦æ˜¯å•æœºçš„ 3.2 å€ã€‚**RL è®­ç»ƒæ—¶éœ€æ¶ˆè€—å¤§é‡çš„æ—¶é—´ï¼ˆ\>80%ï¼‰åœ¨å¯¹æ¨¡å‹è¿›è¡Œé‡‡æ ·ï¼ˆmake experienceï¼‰ï¼Œvllm ä½¿ç”¨æ›´å¤šçš„ GPU å¹¶è¡Œå¯ä»¥å¤§å¹…å‡å°‘è®­ç»ƒæ—¶é—´ã€‚

è¡¨ 3.2.1(1) SimpleRL è®­ç»ƒè¿‡ç¨‹ä¸­æµ‹è¯•é›†æŒ‡æ ‡å˜åŒ–

| æ¨¡å‹åç§° | GSM8K | MATH500 | Minerva\_MATH | OlympiadBench | AIME24 | AMC23 | å¹³å‡ |
| --- | --- | --- | --- | --- | --- | --- | --- |
| Qwen2.5-Math-7B-Base | 59.1 | 53.4 | 14.0 | 15.1 | 13.3 | 47.5 | 33.7 |
| PPO-step4 | 77.4 | 67.0 | 19.9 | 27.7 | 13.3 | 60.0 | 44.2 |
| **PPO-step12** | 80.4 | 66.2 | 16.5 | 26.1 | 10.0 | 42.5 | **40.3** |
| PPO-step20 | 84.8 | 67.2 | 20.2 | 29.6 | 23.3 | 50.0 | 45.9 |
| PPO-step40 | 88.3 | 76.8 | 29.0 | 35.1 | 23.3 | 55.0 | 51.2 |
| PPO-step60 | 90.5 | 77.2 | 32.0 | 38.4 | 20.0 | 57.5 | 52.6 |
| PPO-step80 | 89.6 | 77.0 | 33.1 | 38.5 | 20.0 | 57.5 | 52.6 |
| PPO-step100 | 89.8 | 76.0 | 31.2 | 37.2 | 40.0 | 60.0 | 55.7 |
| PPO-step120 | 90.1 | 78.6 | 29.0 | 35.1 | 23.3 | 57.5 | 52.3 |
| PPO-step140 | 90.1 | 76.6 | 29.8 | 38.2 | 23.3 | 55.0 | 52.2 |
| PPO-step160 | 89.4 | 76.6 | 31.6 | 37.6 | 26.7 | 57.5 | 53.2 |

**æ¨¡å‹åœ¨å„å¤§æ•°å­¦æµ‹è¯•é›†ä¸Šçš„è¡¨ç°å¤§è‡´æ˜¯ç¨³æ­¥æå‡çš„**ã€‚å°½ç®¡è®­ç»ƒåœ¨å‰æœŸï¼ˆstep=12ï¼‰å‘ç”Ÿè¾“å‡ºé•¿åº¦éª¤é™çš„æ—¶å€™ï¼Œæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„è¡¨ç°ä¹Ÿå‡ºç°äº†æ³¢åŠ¨ã€‚ä½†éšç€è®­ç»ƒçš„ç¨³æ­¥æ¨è¿›ï¼Œæ¨¡å‹çš„è¾“å‡ºé•¿åº¦ç¨³æ­¥å›å‡ã€‚

**éšç€è¾“å‡ºé•¿åº¦å¤§è‡´ç¨³å®šï¼Œæµ‹è¯•é›†çš„æ€§èƒ½ä¹ŸåŸºæœ¬ä¸å˜**ã€‚åœ¨ step=60 ä»¥åï¼Œè¾“å‡ºé•¿åº¦åŸºæœ¬ç¨³å®šåœ¨ä¸€ä¸ªå¹³å‡å€¼é™„è¿‘ï¼Œè€Œæ­¤æ—¶çš„å„ä¸ªæµ‹è¯•é›†å¹³å‡æŒ‡æ ‡ä¹Ÿç»´æŒåœ¨ 53 å·¦å³ã€‚

**ä»…åŸºäº format ä¸ accuracy çš„ RL è®­ç»ƒèƒ½å¤Ÿå¸¦æ¥ä¸€å®šçš„æ³›åŒ–æ€§**ã€‚å°½ç®¡è®­ç»ƒé›†æ˜¯ä» MATH500 ä¸­é€‰å–çš„éƒ¨åˆ†éš¾åº¦æ•°æ®ï¼Œä½†æ¨¡å‹åœ¨å¤šä¸ªæ•°æ®é›†ä¸Šå‡è¡¨ç°å‡ºä¸€è‡´æå‡çš„ç°è±¡ã€‚

| åˆ†æ­¥éª¤æ€è€ƒ | åæ€ |
| --- | --- |
| ![Image 3: img](assets/b/e/be6ed1cfcc764e137a8b5eb9e3653e4c.png) | ![Image 4: img](assets/5/e/5ed0292e2323e900ae43160e2b201f0c.png) |

å›¾ 3.2.1(2) SimpleRL è®­ç»ƒè¿‡ç¨‹ä¸­æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„åˆ†æ­¥éª¤æ€è€ƒï¼ˆå·¦ï¼‰ä¸åæ€ï¼ˆå³ï¼‰å˜åŒ–

**Math Base æ¨¡å‹åœ¨èµ·å§‹é˜¶æ®µå°±å±•ç°å‡ºåˆ†æ­¥éª¤æ€è€ƒèƒ½åŠ›**ã€‚æˆ‘ä»¬ç»Ÿè®¡åˆ†æäº†åˆ†æ­¥éª¤æ€è€ƒçš„å…³é”®è¯å‡ºç°çš„é¢‘æ•°ï¼Œå‘ç°åŸºç¡€æ¨¡å‹å·²å±•ç°å‡ºè¾ƒå¼ºçš„ç›®æ ‡åˆ†è§£ï¼Œåˆ†æ­¥éª¤è§£é¢˜èƒ½åŠ›ã€‚éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œæ¨¡å‹é¦–å…ˆç»å†äº†æ¥è‡ª format å¥–åŠ±çš„ä¼˜åŒ–ï¼ˆstep12ï¼‰ï¼Œåœ¨è¾“å‡ºåˆ†å¸ƒä¸Šå‡ºç°äº†è¾ƒå¤§å˜åŒ–ã€‚ç»§ç»­è®­ç»ƒåæ¨¡å‹èƒ½å¤Ÿé‡æ–°æŒæ¡åˆ†è§£æ­¥éª¤è¿›è¡Œæ¨ç†çš„èƒ½åŠ›ã€‚

```
StepÂ 1,Â Step2,Â ...1.,Â 2.,Â ...

First,Â Second,Â Next,Â Finally

```

**Math Base åæ€èƒ½åŠ›å˜åŒ–è¾ƒå°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„å¤šæ¬¡è‡ªæˆ‘åæ€ï¼›ä½†å¯è§‚å¯Ÿåˆ°å¾®å¼±çš„ aha moment**ã€‚å¯¹æ¨¡å‹åœ¨æœ€å step=160 çš„è¾“å‡ºè¿›è¡Œåˆ†æï¼Œæ¨¡å‹ä»ç„¶å€¾å‘äºåœ¨è¾“å‡ºä¸­ä½¿ç”¨ä»£ç æ ¡éªŒçš„æ–¹å¼è¿›è¡Œ checkï¼Œè€Œä¸æ˜¯ä½¿ç”¨çº¯æ–‡æœ¬çš„åæ€æ–¹å¼ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™æ˜¯åƒé—®çš„ Math Base æ¨¡å‹æœ¬èº«å€¾å‘äºä½¿ç”¨ä»£ç æ¥æ ¡éªŒçš„é¢„è®­ç»ƒæ–¹å¼æœ‰å…³ç³»ï¼ˆstep=0ï¼‰ã€‚è€ƒè™‘åˆ°æœ€ç»ˆæ¨¡å‹è¾“å‡ºé•¿åº¦æ²¡æœ‰ç‰¹åˆ«æ˜æ˜¾çš„å¢é•¿ï¼Œè¿™ä¸€ç‚¹å’Œè‡ªæˆ‘åæ€èƒ½åŠ›çš„å˜åŒ–æƒ…å†µæ˜¯å»åˆçš„ã€‚ä»¥ MATH500 æµ‹è¯•é›†ä¸­çš„ä¸€ä¸ªç¤ºä¾‹è¯´æ˜ï¼Œå¦‚å›¾ 3.2.1(3) æ‰€ç¤ºï¼Œæ¨¡å‹ä¸€å¼€å§‹å°±å·²ç»å…·å¤‡äº†åŸºæœ¬çš„åˆ†æ­¥æ¨ç†æ€ç»´é“¾ã€‚ä½†å—åˆ°é¢„è®­ç»ƒé˜¶æ®µæ•°æ®åå¥½çš„å½±å“ï¼Œæ¨¡å‹æ ¡éªŒæ—¶ä½¿ç”¨çš„æ˜¯ PoTï¼Œå¹¶é€šè¿‡ LLM æ¨¡æ‹Ÿç¼–è¯‘å™¨è¾“å‡ºäº†è¿è¡Œç»“æœï¼ˆoutputï¼‰ã€‚è¿™æ ·çš„æ ¡éªŒæ–¹å¼æœ‰åˆ©äºå€ŸåŠ©ç¼–è¯‘å™¨ç­‰å¤–éƒ¨å·¥å…·æ¥éªŒè¯ï¼Œä½†ä¸åˆ©äºç”Ÿæˆçº¯æ–‡æœ¬çš„æ€ç»´é“¾ã€‚**è¿™ä¹Ÿè§£é‡Šäº†æ¨¡å‹ä¸ºä»€ä¹ˆä¸€å¼€å§‹è¾“å‡ºé•¿åº¦ååˆ†å†—ä½™ï¼ˆç¼–å†™ä»£ç æ ¡éªŒï¼‰**ã€‚éšç€è®­ç»ƒçš„è¿›ä¸€æ­¥è¿›è¡Œï¼Œæ¨¡å‹åœ¨ step=4 å’Œ step=12 çš„æ—¶å€™è¾“å‡ºé•¿åº¦æ€¥å‰§ä¸‹é™ï¼Œå¼€å§‹å‡å°‘ä»£ç æ ¡éªŒã€‚ä½†åœ¨ step=100 çš„æ—¶å€™ï¼Œæ¨¡å‹åˆå€¾å‘äºè¾“å‡ºä»£ç æ ¡éªŒã€‚**è¿™è¯´æ˜äº†è¯¥æ•°å­¦åŸºåº§æ¨¡å‹å¯¹ä»£ç å·¥å…·çš„æ‰§å¿µå¾ˆæ·±**ã€‚æœ€ç»ˆï¼Œæ¨¡å‹åœ¨ step=160 å±•ç°å‡ºäº† aha moment ä¸­çš„åæ€æ­¥éª¤ï¼ˆre - evaluateï¼‰ã€‚

![Image 5](assets/c/e/ce8added6b9ac9a7344b9a343c352d62.png)

å›¾ 3.2.1(3) SimpleRL è®­ç»ƒè¿‡ç¨‹ä¸­æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„è¾“å‡ºå˜åŒ–

**Math Base æ¨¡å‹èƒ½åŒæ—¶é’ˆå¯¹æ–‡æœ¬æ¨ç†ç»“æœæˆ–ä»£ç æ ¡éªŒç»“æœç»™å‡ºåæ€**ã€‚å¦‚å›¾å›¾ 3.2.1(4) æ‰€ç¤ºï¼Œå°½ç®¡æ¨¡å‹è¡¨ç°å‡ºä½¿ç”¨ä»£ç æ ¡éªŒçš„å€¾å‘ï¼Œä½†æ˜¯èƒ½å¤Ÿæ ¹æ®æ¨¡æ‹Ÿç¼–è¯‘ç»“æœæ¥è¿›è¡Œåæ€ï¼Œè¿›è¡Œæ‰“ç£¨ã€‚

![Image 6: img](assets/8/7/87c3ced387ecd2a1b2fdc066a8a2db91.png)

img

å›¾ 3.2.1(4) SimpleRL æµ‹è¯•é›†ä¸Šå±•ç°å‡ºåæ€ç‰¹ç‚¹çš„å›ç­”ç¤ºä¾‹

#### 3.2.2 OpenR1

è®­ç»ƒä¸­çš„æ ¸å¿ƒæŒ‡æ ‡å¦‚ä¸‹å›¾ 3.2.2(1) æ‰€ç¤ºã€‚æ³¨ï¼šè¿™é‡Œ Qwen2.5-1.5B æŒ‡çš„æ˜¯ Instruct æ¨¡å‹ã€‚

| æ ¼å¼å¥–åŠ± | å‡†ç¡®åº¦å¥–åŠ± |
| --- | --- |
| ![Image 7: img](assets/3/b/3b3fa4fecfdbf7ce3c4582553f52135d.png) | ![Image 8: img](assets/9/b/9b01717820c3f625c71c90a1675e913d.png) |

å›¾ 3.2.2(1) OpenR1 è®­ç»ƒè¿‡ç¨‹ä¸­æµ‹è¯•é›†æ ¼å¼å¥–åŠ±ï¼ˆå·¦ï¼‰ä¸å‡†ç¡®åº¦å¥–åŠ±ï¼ˆå³ï¼‰çš„å˜åŒ–ã€‚

**DeepSeek å®˜æ–¹è’¸é¦çš„ Qwen7B æ¨¡å‹æŒ‡ä»¤éµå¾ªèƒ½åŠ›è¾ƒå·®ï¼Œå§‹ç»ˆæ— æ³•å¾ˆå¥½è¾“å‡ºæŒ‡å®šçš„æ€ç»´é“¾ä¸ç­”æ¡ˆæ ¼å¼**ã€‚è¿™é‡Œå›¾ 3.2.2(1) å·¦è¾¹å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº† Qwen2.5-7B åªéœ€è¦è¾“å‡º boxed æ¡†ç»“æœï¼ˆæ— éœ€ç­‰çº¦æŸï¼‰ï¼ŒQwen2.5-1.5B-Instruct ä¸ Deepseek-Distill-Qwen2.5-7B è¡¨ç°å‡ºäº†æˆªç„¶ä¸åŒçš„æ›²çº¿ã€‚Deepseek-Distill-Qwen2.5-7B å‡ ä¹æ²¡æœ‰åŠæ³•å­¦åˆ°æŒ‡å®šçš„æ ¼å¼ã€‚1.5B é‡çº§çš„æ¨¡å‹å—é™äºä½“é‡ï¼Œè™½ç„¶èƒ½å¤Ÿéµå¾ªæ ¼å¼æŒ‡ä»¤ï¼Œä½†æœªæ˜¾è‘—æå‡å‡†ç¡®ç‡ã€‚

**Qwen2.5-Math-7B-Base çš„å¤ç°ç»“æœä¸ SimpleRL åŸºæœ¬ä¸€è‡´**ã€‚è™½ç„¶è®­ç»ƒæ•°æ®æ˜¯ä» MATH æºé€‰å–çš„ï¼Œä½†é™¤ MATH å¤–çš„å…¶ä½™æµ‹è¯•é›†ï¼ˆå¦‚ GSM8K ç­‰ï¼‰ä¹Ÿæœ‰ç•¥å¾®æå‡ã€‚**DeepSeek-Distill-Qwen-7B çš„ GRPO è®­ç»ƒå­˜åœ¨æ³¢åŠ¨**ï¼Œæˆ‘ä»¬è®¤ä¸ºå½“å‰è¶…å‚è®¾ç½®å¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼Œè¿˜éœ€ä»”ç»†å¾®è°ƒã€‚

è¡¨ 3.2.2(1) OpenR1 è®­ç»ƒè¿‡ç¨‹ä¸­ Qwen2.5-Math-7B-Base åœ¨æµ‹è¯•é›†ä¸Šçš„å˜åŒ–

| æ¨¡å‹åç§° | GSM8K | MATH500 | Minerva\_MATH | OlympiadBench | AIME24 | AMC23 | å¹³å‡ |
| --- | --- | --- | --- | --- | --- | --- | --- |
| Qwen2.5-Math-7B-Base | 59.1 | 53.4 | 14.0 | 15.1 | 13.3 | 47.5 | 33.7 |
| GRPO-step100 | 84.2 | 74.4 | 29.0 | 35.6 | 26.7 | 57.5 | 51.2 |
| GRPO-step200 | 85.2 | 71.6 | 26.1 | 35.7 | 30.0 | 60.0 | 51.4 |
| GRPO-step300 | 86.4 | 74.2 | 36.4 | 32.7 | 26.7 | 55.0 | 51.9 |
| GRPO-step400 | 84.4 | 72.0 | 32.0 | 33.0 | 10.0 | 57.5 | 48.2 |

è¡¨ 3.2.2(2) OpenR1 è®­ç»ƒè¿‡ç¨‹ä¸­ DeepSeek-Distill-Qwen-7B-Base åœ¨æµ‹è¯•é›†ä¸Šçš„å˜åŒ–

| æ¨¡å‹åç§° | GSM8K | MATH500 | Minerva\_MATH | OlympiadBench | AIME24 | AMC23 | å¹³å‡ |
| --- | --- | --- | --- | --- | --- | --- | --- |
| DeepSeek-Distill-Qwen-7B-Instruct | 89.6 | 89.6 | 36.4 | 51.1 | 26.7 | 87.5 | 63.5 |
| GRPO-step100 | 89.1 | 85.6 | 41.5 | 46.2 | 46.7 | 82.5 | 65.3 |
| GRPO-step200 | 82.8 | 75.8 | 35.3 | 37.9 | 6.7 | 50.0 | 48.1 |
| GRPO-step300 | 82.2 | 78.8 | 32.7 | 39.3 | 40.0 | 62.5 | 55.9 |
| GRPO-step400 | 87.9 | 81.4 | 38.2 | 40.9 | 30.0 | 72.5 | 58.5 |

#### 3.2.3 LogicRL

**Stage1 ä¼˜åŒ–**

è¯¥é˜¶æ®µä½¿ç”¨ PPL=3ï¼ˆå³ä¸‰ä¸ªäººçš„ KK é—®é¢˜ï¼‰å¯¹æ¨¡å‹è¿›è¡Œé¢„çƒ­ï¼Œä»…è®­ç»ƒ 1epã€‚è€ƒè™‘åˆ° GRPO è®­ç»ƒæ—¶ç›¸æ¯”äº PPO ä¸€èˆ¬ä¼šæ¯”è¾ƒä¸ç¨³å®šï¼Œä¸”å—åˆ° rollout æ•°é‡ã€batch size ç­‰å½±å“è¾ƒå¤§ï¼Œé€‰æ‹©ä»ç®€å•çš„é¢˜ç›®å…¥æ‰‹å¯ä»¥è®©æ¨¡å‹å…ˆå…·å¤‡è§£å†³ KK é—®é¢˜çš„åˆæ­¥æ¨ç†æ–¹å¼ã€‚

**æŒ‡ä»¤å¯¹é½èƒ½åŠ›å¯¹äºè§£å†³ KK é—®é¢˜æœ‰æ˜æ˜¾æ”¶ç›Š**ã€‚æˆ‘ä»¬ä»å›¾ 3.2.3(1) å¯çŸ¥ï¼Œç»è¿‡å¯¹é½åçš„ Qwen2.5-7B-Instruct æ¨¡å‹ä¸€å¼€å§‹ä¾¿å–å¾—äº† 0.45 å·¦å³çš„å‡†ç¡®ç‡ã€‚

**ä¸€é˜¶æ®µ RL è®­ç»ƒç•¥å¾®æå‡äº†æ¨¡å‹å¹³å‡çš„å›å¤é•¿åº¦**ã€‚æ¨¡å‹åœ¨åˆå§‹é˜¶æ®µåˆ©ç”¨é¢„è®­ç»ƒçš„èƒ½åŠ›å³å¯ç”Ÿæˆ 400 å­—å·¦å³é•¿åº¦çš„åˆç†æ€ç»´é“¾ï¼Œå°½ç®¡æ­¤æ—¶å¹¶æ²¡æœ‰å‡ºç°æ˜æ˜¾çš„åæ€èƒ½åŠ›ã€‚

| æµ‹è¯•é›†æŒ‡æ ‡ | å›å¤é•¿åº¦ |
| --- | --- |
| ![Image 9: img](assets/a/9/a9c3e22d2e295ff0ddb74204f093690e.png) | ![Image 10: img](assets/c/f/cfec976987ea3b8e644b091c1b351332.png) |

å›¾ 3.2.3(1) LogicRL ä¸€é˜¶æ®µè®­ç»ƒè¿‡ç¨‹ä¸­æµ‹è¯•é›†æŒ‡æ ‡ï¼ˆå·¦ï¼‰ä¸å›å¤é•¿åº¦ï¼ˆå³ï¼‰çš„å˜åŒ–

| ç­”æ¡ˆé”™è¯¯å æ¯” | æ ¼å¼é”™è¯¯å æ¯” |
| --- | --- |
| ![Image 11: img](assets/4/c/4cbc6124d8557f74a7d2e455ee1fb582.png) | ![Image 12: img](assets/5/9/591c26feaab39fe797d893398c88eac7.png) |

å›¾ 3.2.3(2) LogicRL ä¸€é˜¶æ®µè®­ç»ƒè¿‡ç¨‹ä¸­ç­”æ¡ˆé”™è¯¯å æ¯”ï¼ˆå·¦ï¼‰ä¸æ ¼å¼é”™è¯¯å æ¯”ï¼ˆå³ï¼‰çš„å˜åŒ–

**æ ¼å¼é”™è¯¯å æ¯”ä¸‹é™é€Ÿåº¦å¾ˆå¿«ï¼Œä½†ç­”æ¡ˆé”™è¯¯å æ¯”ä»å±…é«˜ä¸ä¸‹**ã€‚åƒé—® Base æ¨¡å‹ä»…éœ€è¿­ä»£è‹¥å¹²æ­¥å³å¯å°†æ ¼å¼é”™è¯¯å æ¯”æ”¶æ•›åˆ° 5%ä»¥ä¸‹ã€‚è€ŒæŒ‡ä»¤å¯¹é½åçš„ Instruct ç‰ˆæœ¬èµ·å§‹é˜¶æ®µå°±å…·å¤‡è‰¯å¥½çš„æ ¼å¼éµå¾ªèƒ½åŠ›ï¼Œèƒ½å¤Ÿè¾“å‡ºæ­£ç¡®çš„æ ¼å¼ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºæ­¤æ—¶æ¨¡å‹å¹¶æœªå±•ç°å‡ºåæ€èƒ½åŠ›ï¼Œç­”æ¡ˆé”™è¯¯çš„å æ¯”ä¸€ç›´ç¨³å®šåœ¨ 60%~70% å·¦å³ã€‚

**Stage2 ä¼˜åŒ–**

è¯¥é˜¶æ®µä½¿ç”¨ PPL=5 å¯¹æ¨¡å‹è¿›è¡Œè¿›ä¸€æ­¥çš„ä¼˜åŒ–ã€‚æˆ‘ä»¬åŠ è½½æ¥è‡ªä¸€é˜¶æ®µæœ«å°¾çš„ ckpt æ¥åˆå§‹åŒ– actor æ¨¡å‹ã€‚æ­¤é˜¶æ®µéœ€è¦è°ƒæ•´é‡‡æ ·çš„æ¸©åº¦è¶…å‚ï¼ŒåŒæ—¶å¢åŠ  rollout çš„æ ·æœ¬æ•°é‡ã€‚é€šè¿‡å¢åŠ é‡‡æ ·ç»“æœçš„å¤šæ ·æ€§æ¥å…è®¸å¸¦æœ‰æ€ç»´é“¾è§£æ³•çš„å›ç­”å‡ºç°ï¼Œè¿›ä¸€æ­¥æ¥é¼“åŠ±æ¨¡å‹ç”Ÿäº§è¿™æ ·çš„æ€ç»´é“¾ç­”æ¡ˆã€‚

**äºŒé˜¶æ®µè®­ç»ƒä¸­å—åˆ°æ¸©åº¦ç³»æ•°ä¸é‡‡æ · rollout æ•°é‡è¶…å‚å½±å“è¾ƒå¤§**ã€‚å®˜æ–¹é¡¹ç›®ä¸­æåŠçš„æ¸©åº¦ç³»æ•° temperature=1.2~1.5 å¯¹äº Qwen 7B é‡çº§çš„æ¨¡å‹æ¥è¯´ä»ç„¶æœ‰äº›å¤§ï¼Œæ¯”è¾ƒå®¹æ˜“è®­å´©ã€‚å‚è€ƒå›¾ 3.2.3(2)ï¼Œæˆ‘ä»¬ç»™å‡ºäº†ä¸€ç»„è¶…å‚è®¾ç½®ï¼ˆtemperature=1.2ï¼Œrollout.n=32ï¼‰ä¸‹è®­ç»ƒå´©æºƒçš„å®éªŒæ›²çº¿ã€‚è€ƒè™‘åˆ°äº”ä¸ªäººçš„ KK é—®é¢˜åœ¨éš¾åº¦ä¸Šå°±ä¼šè¿œé«˜äºä¸‰ä¸ªäººçš„ KK é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ä¼˜åŒ–ç¬¬äºŒé˜¶æ®µæ—¶éœ€è¦ç¡®ä¿æ¨¡å‹æ˜¯ç¨³å¥è€Œä¸æ˜¯æ¿€è¿›è®­ç»ƒçš„ã€‚å¦‚æœæ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸€ç›´æ²¡æœ‰å¾—åˆ°æœ‰æ•ˆçš„å¥–åŠ±æ¥é¼“èˆå¸¦æœ‰ self-reflection ç­”æ¡ˆçš„è¾“å‡ºï¼Œè®­ç»ƒä¸€æ®µæ—¶é—´åæ¨¡å‹æ²¡æœ‰ä»»ä½•æœ¬è´¨æå‡ï¼Œæå…¶å®¹æ˜“å¯¼è‡´åå¡Œã€‚ä»¥å›¾ 3.2.3(2) ä¸­å›å¤é•¿åº¦çš„å˜åŒ–æ›²çº¿æ¥çœ‹ï¼Œåœ¨ step=140 æ—¶ï¼Œæ¨¡å‹ç›´æ¥æ— æ³•åœæ­¢ï¼Œinstruct æ¨¡å‹ä¸åå‡º "<|im\_end|\>"ã€base æ¨¡å‹ä¸åå‡º "<|end\_of\_text|\>"ï¼Œåå¤è¯´æ²¡æœ‰æ„ä¹‰çš„å†…å®¹ç›´åˆ°è¶…å‡ºé¢„è®¾å›ç­”çš„é•¿åº¦ä¸Šé™ã€‚åœ¨ step=140 æ—¶ï¼Œæ¨¡å‹ä¸ä»…å‡ºç°äº†å¤§é‡çš„é”™è¯¯ç­”æ¡ˆï¼Œä¹Ÿå‡ºç°äº†æ ¼å¼é”™è¯¯æš´æ¶¨çš„é—®é¢˜ã€‚è¿™äº›ç°è±¡ä¸å…¶æµ‹è¯•é›†æŒ‡æ ‡æš´è·Œç›¸äº’ä½è¯ï¼Œè¯´æ˜äº†æ¨¡å‹æ­£åœ¨åå¡Œã€‚

| ![Image 13](assets/5/0/506b388e54e0ed9f0f57b1cd6b0cce7e.png) | ![Image 14: img](assets/b/f/bf09e8f03ec2d34617365975075b3a9b.png) |
| --- | --- |
| ![Image 15: img](assets/4/4/4475aa9c3fa3aa5bd91ee7f7704b2327.png) | ![Image 16: img](assets/8/b/8bdab8f5ce02f40e655623ef74515dfb.png) |

å›¾ 3.2.3(2) LogicRL äºŒé˜¶æ®µè®­ç»ƒè¿‡ç¨‹ä¸­ä¸åˆé€‚çš„è¶…å‚è®¾ç½®å¯¼è‡´çš„è®­ç»ƒå´©æºƒé—®é¢˜

**GRPO è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŠ–åŠ¨è¾ƒå¤§ã€‚**å³ä½¿é€šè¿‡åˆç†è°ƒæ•´è¶…å‚èƒ½å¤Ÿé¿å…äº†æ¨¡å‹åå¡Œçš„é—®é¢˜ï¼Œä½†æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬å‘ç°æ¨¡å‹çš„è¾“å‡ºé•¿åº¦å˜åŒ–ã€é”™è¯¯ç­”æ¡ˆå æ¯”ç­‰å˜åŒ–è¾ƒå‰§çƒˆï¼ˆå¦‚å›¾ 3.2.3(3) æ‰€ç¤ºï¼‰ã€‚è¿™æ„å‘³ç€æ¨¡å‹è§£å†³ PPL=5 æ—¶çš„æŒ‘æˆ˜è¾ƒå¤§ï¼Œå¾ˆéš¾æ‰¾åˆ°å®¹æ˜“çš„è§£æ³•å¥—è·¯ï¼Œæ€§èƒ½æå‡ååˆ†åå·ã€‚

**ç›¸æ¯”äº Qwen-Instructï¼ŒQwen-Base è¡¨ç°å‡ºæ›´è¯¦ç»†ç¼œå¯†çš„æ¨ç†é“¾è¿‡ç¨‹ã€‚**ä¸ºäº†æ¢ç©¶åœ¨è®­ç»ƒç»“æŸæ—¶ Qwen2.5-7B-Base ä¸ Instruct åœ¨é•¿åº¦ä¸Šçš„å·®å¼‚ï¼Œæˆ‘ä»¬éšæœºé€‰å–äº†ä¸€ä¸ªç¤ºä¾‹è¿›è¡Œåˆ†æã€‚å¦‚å›¾ 3.2.3(4) æ‰€ç¤ºï¼Œè¿™ä¸¤ä¸ªæ¨¡å‹éƒ½åšå¯¹äº†è¿™é“é¢˜ç›®ï¼Œä½† Base æ¨¡å‹å±•ç¤ºå‡ºäº†æ›´ä¸ºç¼œå¯†çš„æ€ç»´é“¾ã€‚å…·ä½“åœ°ï¼ŒBase æ¨¡å‹ä» "Samuel" æ˜¯ knight è¿˜æ˜¯ knave è¿›è¡Œåˆ†æƒ…å†µè®¨è®ºï¼Œç„¶åå†åœ¨æ¯ä¸ªæ¡ä»¶ä¸‹ä¾æ¬¡åˆ†æå‰©ä¸‹æ¥çš„ "Charelott, Mia, Daniel, Jackson" è¿™å‡ ä¸ªäººçš„è¯èƒ½å¦åŒæ—¶æˆç«‹ã€‚é€šè¿‡äº¤å‰éªŒè¯å¯ä»¥å…ˆæ’é™¤ "Samuel æ˜¯ knight" è¿™ä¸€ä¸ªå‰ææƒ…å†µï¼›å†ç»§ç»­åˆ†æç¬¬äºŒç§å‰æã€‚ç›¸ååœ°ï¼ŒInstruct æ¨¡å‹å€¾å‘äºä¼˜å…ˆæŠŠæ¯ä¸ªäººçš„è¯è¿›è¡Œæ€»ç»“æ€§åˆ†æï¼Œå¹¶åŒæ—¶ç»™å‡ºæ¯ä¸ªäººæ˜¯ knight æˆ–è€…æ˜¯ knave æ—¶çš„å£°æ˜æˆç«‹æƒ…å†µï¼Œä¸€æ­¥åˆ°ä½ç»™å‡ºç»Ÿç­¹æ€§çš„åˆ†æç»“è®ºã€‚Instruct æ¨¡å‹åœ¨æ¨ç†é“¾ä¸Šå€¾å‘äºçœç•¥å°æ­¥éª¤ï¼Œé€šè¿‡çœç•¥éƒ¨åˆ†æ¨å¯¼è¿‡ç¨‹æ¥å‹ç¼©æ¨ç†é“¾ï¼Œå¯è§£é‡Šæ€§ä¸‹é™ã€‚è¿™å¯èƒ½æ˜¯å› ä¸º **Instruct æ¨¡å‹ç»è¿‡äº†å¤§é‡é long CoT è¡¨ç¤ºçš„ SFT æ•°æ®ã€DPO ä¼˜åŒ–ç­‰åå¥½å¯¹é½åï¼Œå€¾å‘äºçœç•¥æ¨ç†å†…å®¹ç»™å‡ºç›´æ¥çš„ã€ç®€æ˜æ‰¼è¦çš„å›ç­”**ã€‚Base æ¨¡å‹æ›´å¤šåœ°æ˜¯æ¿€æ´»é¢„è®­ç»ƒè¯­æ–™ä¸­å†…åœ¨çš„æ¨è®ºè¡¨è¾¾æ–¹å¼ï¼Œé€šè¿‡ç¼œå¯†çš„ä¸€æ­¥æ­¥æ¨å¯¼æ¥é€æ¸å¯¼å‘æœ€ç»ˆç»“è®ºã€‚å¦‚æœåç»­è¦åŸºäº SFT/Instruct æ¨¡å‹è¿›è¡Œç»§ç»­ç±» R1 çš„è®­ç»ƒæ—¶ï¼Œéœ€è¦ä¿è¯ SFT é˜¶æ®µå·²ç»å­˜åœ¨äº†å¤§é‡çš„ long CoT å½¢å¼çš„æ•°æ®æ¥å¼•å¯¼æ¨¡å‹ç»™å‡ºå¸¦è¯¦ç»†æ¨ç†é“¾çš„ç­”æ¡ˆã€‚

| ![Image 17: img](assets/f/0/f032279c9c008b91771fb2a3bb96a03a.png) | ![Image 18: img](assets/b/a/bae8878e751e4a22382758d304f9d0e1.png) |
| --- | --- |
| ![Image 19: img](assets/2/c/2cde1b196d4e1c06f09d4d6602c5fe34.png) | ![Image 20: img](assets/0/1/01b331c229fa80fd84d7644a4b06e4b1.png) |

å›¾ 3.2.3(3) LogicRL äºŒé˜¶æ®µè®­ç»ƒè¿‡ç¨‹ä¸­åˆç†çš„è¶…å‚è°ƒæ•´é¿å…æ¨¡å‹å´©å¡Œ

![Image 21: img](assets/8/c/8c6d4083e198a1ddb40f4c0a5c51b0a4.png)

img

å›¾ 3.2.3(4) LogicRL äºŒé˜¶æ®µç»“æŸæ—¶ Qwen2.5-7B-Base ä¸ Instruct åœ¨è®­ç»ƒé›†ä¸Šçš„æ¨ç†ç¤ºä¾‹

**Stage3 ä¼˜åŒ–**

ç¬¬ä¸‰é˜¶æ®µè¿›è¡Œæ¼«é•¿çš„é€€ç«é˜¶æ®µæ¥è¿›ä¸€æ­¥æå‡æ¨¡å‹æ€ç»´é“¾çš„è´¨é‡ã€‚ç”±äºå¼€æºé¡¹ç›®å¹¶æ²¡æœ‰å…·ä½“ç»™å‡ºæ¯ä¸ªé˜¶æ®µçš„å…·ä½“å‚æ•°è®¾ç½®ï¼Œæˆ‘ä»¬æ ¹æ®å·²æœ‰ç»éªŒåœ¨è¿™ä¸€é˜¶æ®µç»§ç»­é™ä½å­¦ä¹ ç‡ï¼Œè°ƒä½æ¸©åº¦ç³»æ•°ï¼Œè®©æ¨¡å‹å¹³ç¨³åœ°æ”¶æ•›ã€‚ç¬¬ä¸‰é˜¶æ®µä½¿ç”¨çš„è®­ç»ƒæ•°æ®ä¸ç¬¬äºŒé˜¶æ®µä¸€è‡´ï¼Œå­¦ä¹ ç‡éƒ½éµå¾ª cosine è¡°å‡ç­–ç•¥ã€‚

**ç›¸åŒæ­¥é•¿ä¸‹ Base æ¨¡å‹ä¸ Instruct æ¨¡å‹æ”¶æ•›çš„æœ€ç»ˆå‡†ç¡®ç‡æ¥è¿‘ï¼Œä½† Base ç¨å¥½**ã€‚è§‚å¯Ÿåˆ°å›¾ 3.2.3(5) å·¦è¾¹çš„æ›²çº¿ï¼Œä¸¤ä¸ªæ¨¡å‹æœ€ç»ˆæ”¶æ•›çš„æ°´å¹³ç›¸å½“ã€‚ç¬¬ä¸‰é˜¶æ®µ step=0 æ—¶ï¼ŒInstruct æ¨¡å‹èµ·å§‹çš„å‡†ç¡®ç‡æ›´ä½ï¼Œå› æ­¤è¿™ä¸€é˜¶æ®µ Instruct æ¨¡å‹çš„ç›¸å¯¹å¢ç›Šæ›´å¤§ã€‚å›¾ 3.2.3(5) å³è¾¹è¾“å‡ºé•¿åº¦çš„å˜åŒ–æƒ…å†µä¹Ÿå¯ä»¥ä½è¯ **Instruct æ¨¡å‹ç»å†äº†æ›´ä¸ºæ˜æ˜¾çš„é•¿åº¦é€’å¢é˜¶æ®µ**ï¼Œè¾“å‡ºé•¿åº¦å¿«é€Ÿåœ°ä» 700 å·¦å³æ‹‰å‡åˆ° 1200ï¼Œå½¢æˆäº†å®Œæ•´çš„é•¿æ€ç»´é“¾ã€‚èµ·æ­¥é˜¶æ®µ Instruct æ¨¡å‹æ…¢ä¸€äº›ï¼Œéœ€è¦**ã€Œå…ˆç ´åç«‹ã€**æ¥æ‘†è„±æ—¢æœ‰çš„ response å€¾å‘æ€§ã€‚å‡ä»¥æ—¶æ—¥ï¼ŒInstruct æ¨¡å‹èƒ½çªç„¶å¼€çªï¼ŒæŒæ¡æ€ç»´é“¾çš„è¾“å‡ºèŒƒå¼ã€‚

**Base å’Œ Instruct æ¨¡å‹çš„é”™è¯¯ç‡ç¨³æ­¥ä¸‹é™ï¼Œæ ¼å¼éµå¾ªé”™è¯¯ç‡ç»´æŒåœ¨ä½ç‚¹ã€‚**ä»¥å›¾ 3.2.3(6) æ‰€ç¤ºï¼Œé€šè¿‡ç¬¬ä¸‰é˜¶æ®µåˆç†è®¾ç½®äº†é€€ç«çš„è¶…å‚ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå®ç°å¹³ç¨³çš„è®­ç»ƒè¿‡ç¨‹ã€‚

| æµ‹è¯•é›†æŒ‡æ ‡ | å›å¤é•¿åº¦ |
| --- | --- |
| ![Image 22: img](assets/4/1/41fa44f5d67bf024a8778d1ef0d16612.png) | ![Image 23: img](assets/4/0/4041e795ab0e0e82e552d2ff8994ec6b.png) |

å›¾ 3.2.3(5) LogicRL ä¸‰é˜¶æ®µè®­ç»ƒè¿‡ç¨‹ä¸­æµ‹è¯•é›†æŒ‡æ ‡ï¼ˆå·¦ï¼‰ä¸å›å¤é•¿åº¦ï¼ˆå³ï¼‰çš„å˜åŒ–

| ç­”æ¡ˆé”™è¯¯å æ¯” | æ ¼å¼é”™è¯¯å æ¯” |
| --- | --- |
| ![Image 24: img](assets/8/d/8d7f1e588edd25d933b349d2ba4416b7.png) | ![Image 25: img](assets/9/b/9b6ac339cc0afc4bc0e0f985df4ba55f.png) |

å›¾ 3.2.3(6) LogicRL ä¸‰é˜¶æ®µè®­ç»ƒè¿‡ç¨‹ä¸­ç­”æ¡ˆé”™è¯¯å æ¯”ï¼ˆå·¦ï¼‰ä¸æ ¼å¼é”™è¯¯å æ¯”ï¼ˆå³ï¼‰çš„å˜åŒ–

**Base ä¸ Instruct æ¨¡å‹å‡èƒ½è§è¯ aha momentï¼Œå±•ç°å‡ºå¸¦åˆ†æ­¥éª¤ã€branching æ¨ç†ã€è‡ªæˆ‘åæ€ä¸æ ¡éªŒçš„ç‰¹æ€§**ã€‚è®­ç»ƒç»“æŸæ—¶éšæœºæŒ‘é€‰äº†ä¸€ä¸ªè®­ç»ƒé›†ä¸­æ ·æœ¬ï¼Œå¦‚å›¾ 3.2.3(7) æ‰€ç¤ºï¼Œä¸¤ä¸ªæ¨¡å‹éƒ½å‡ºç°äº†å¤šä¸ªåˆ†æƒ…å†µè®¨è®ºå‰æä¸‹ï¼Œstep-by-step æ¨ç†çš„æ€ç»´é“¾ï¼Œå¹¶åœ¨æ¯ç§å¤§å‰æè®¨è®ºåè¿›è¡Œ "re - evaluate"/"re - check"ï¼Œæ€»ç»“æ€§åœ°ç»™å‡ºæœ€åçš„åˆ¤æ–­ç»“æœã€‚

**Base ä¸ Instruct æ¨¡å‹è¾“å‡ºçš„å›ç­” token æ•°é‡åŸºæœ¬ä¸å˜ï¼Œå›å¤é•¿åº¦å¢é•¿å‡æ¥è‡ªäºæ€è€ƒé“¾çš„å¢åŠ **ã€‚æˆ‘ä»¬é€‰å–ä»£è¡¨æ€§çš„ ckpt æ¥æ¨ç†äº†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œè¿›ä¸€æ­¥æ‹†è§£äº†æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­çš„å›å¤å†…å®¹ã€‚å¦‚å›¾ 3.2.3(8) æ‰€ç¤ºï¼Œéšç€è®­ç»ƒæ­¥æ•°çš„å¢åŠ ï¼Œæ¨¡å‹æ€è€ƒé“¾çš„é•¿åº¦åœ¨ä¸æ–­å¢åŠ ï¼Œè€Œå›ç­”çš„ç­”æ¡ˆé•¿åº¦åŸºæœ¬ä¿æŒä¸å˜ï¼Œè¿™è¯´æ˜äº†è¯¥é˜¶æ®µçš„ç¡®æ˜¯åœ¨æ˜¾è‘—æå‡æ€è€ƒé“¾ã€‚

**Base ä¸ Instruct æ¨¡å‹åœ¨åˆ†æ­¥éª¤æ¨ç†ä¸Šçš„èƒ½åŠ›å¿«é€Ÿæå‡åè¿›å…¥å¹³å°æœŸï¼Œè‡ªæˆ‘åæ€èƒ½åŠ›å…ˆä¸Šå‡ç„¶åç•¥æœ‰ä¸‹é™ã€‚**å¦‚å›¾ 3.2.3(9) æ‰€ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å…³é”®è¯çš„æ–¹å¼æ¥ä»”ç»†åœ°åˆ†æäº†æ¨¡å‹æ€ç»´é“¾ï¼ˆå³...ä¹‹é—´çš„å†…å®¹ï¼‰ã€‚å¯¹äºåˆ†æ­¥éª¤æ¨ç†èƒ½åŠ›ï¼Œç”±äºæ¨¡å‹çš„è¾“å‡ºé•¿åº¦åœ¨ä¸æ–­è¾¹é•¿ï¼Œå…¶ long CoT å†…å®¹ä¸­å‡ºç°äº†è¶Šæ¥è¶Šå¤šçš„åˆ†æ­¥éª¤ã€åˆ†ç‚¹è§£é¢˜çš„å…³é”®è¯ã€‚ä½†å¯¹äºè‡ªæˆ‘åæ€èƒ½åŠ›è€Œè¨€ï¼Œéšç€æ¨¡å‹è¿‡æ‹Ÿåˆè¯¥æ•°æ®é›†ï¼Œè‡ªæˆ‘åæ€çš„èƒ½åŠ›åœ¨æŠµè¾¾æœ€é«˜å€¼åç•¥æœ‰ä¸‹é™ã€‚è¿™è¯´æ˜äº†æ¨¡å‹å€¾å‘äºåœ¨æ¯”è¾ƒæœ‰è‡ªä¿¡çš„é¢˜ç›®ï¼ˆæ‹Ÿåˆå®Œå¤‡ï¼‰ä¸Šä¸åæ€ã€‚åç»­è¿›è¡Œç›¸å…³ç±» R1 å®éªŒæ—¶ï¼Œéœ€è¦å……åˆ†ä¿è¯è®­ç»ƒé›†ä¸­æœ‰ä¸åŒéš¾åº¦çš„æ•°æ®ï¼Œå¹¶åˆ©ç”¨å›°éš¾æ•°æ®æ¥ç»´æŒæ¨¡å‹è‡ªæˆ‘åæ€çš„æ¨¡å¼ä¸é€€åŒ–ã€‚

![Image 26: img](assets/a/3/a3bafbb5d007bc72a2341cdbe84ef5c5.png)

img

å›¾ 3.2.3(7) LogicRL ä¸‰é˜¶æ®µç»“æŸæ—¶ Qwen2.5-7B-Base ä¸ Qwen2.5-7B-Instruct åœ¨è®­ç»ƒé›†ä¸Šçš„æ¨ç†ç¤ºä¾‹

| è®­ç»ƒé›† | æµ‹è¯•é›† |
| --- | --- |
| ![Image 27: img](assets/5/2/521d0e8fcf53d13a4f06154ea7436125.png) | ![Image 28: img](assets/4/0/40bc71031a798bc939bbd801321c3f44.png) |

å›¾ 3.2.3(8) LogicRL ä¸‰é˜¶æ®µè¿‡ç¨‹ä¸­è®­ç»ƒé›†ï¼ˆå·¦ï¼‰ä¸æµ‹è¯•é›†ï¼ˆå³ï¼‰ä¸Šæ€è€ƒä¸å›ç­”é•¿åº¦çš„å˜åŒ–

| åˆ†æ­¥æ¨ç† | åæ€ |
| --- | --- |
| ![Image 29: img](assets/c/0/c0ef01e288fd7dae1ec61cfc93787b5b.png) | ![Image 30: img](assets/d/e/dea06a5dc157148c03ff1b154b86e6d5.png) |

å›¾ 3.2.3(9) LogicRL ä¸‰é˜¶æ®µè¿‡ç¨‹ä¸­æ¨¡å‹ CoT åˆ†æ­¥æ¨ç†ä¸åæ€ pattern å˜åŒ–

#### 3.2.4 TinyZero

**PPO ä¼˜åŒ–**

æˆ‘ä»¬åŒæ—¶é€‰ç”¨äº†åƒé—® 2.5-3B-Base ä»¥åŠåƒé—® 2.5-7B-Base ä½œä¸ºåŸºç¡€ï¼ŒåŸºæœ¬å¤ç°äº†è¯¥å¼€æºé¡¹ç›®ä¸­çš„æŒ‡æ ‡ã€‚æ ¸å¿ƒçš„è®­ç»ƒè¿‡ç¨‹ç¤ºæ„å›¾å¦‚ä¸‹ã€‚

| æµ‹è¯•é›†æŒ‡æ ‡ | å›å¤é•¿åº¦ |
| --- | --- |
| ![Image 31: img](assets/4/9/494e018bbaf60eba940df06439ff6413.png) | ![Image 32: img](assets/2/c/2cda5e4e2f18048436d534398ea8dff1.png) |

å›¾ 3.2.4(1) TinyZero è®­ç»ƒè¿‡ç¨‹ä¸­æµ‹è¯•é›†æŒ‡æ ‡ï¼ˆå·¦ï¼‰ä¸å›å¤é•¿åº¦ï¼ˆå³ï¼‰çš„å˜åŒ–

**ç›¸åŒæ•ˆæœä¸‹ï¼Œ3B é‡çº§æ¨¡å‹éœ€è¦æ›´é•¿æ—¶é—´æ‰èƒ½æ”¶æ•›**ã€‚3B æ¨¡å‹åœ¨èµ·å§‹é˜¶æ®µå°±æ¯” 7B æ¨¡å‹ä½äº† 7% å·¦å³ï¼›åœ¨è¿­ä»£äº†æ¥è¿‘ 500 æ­¥åï¼Œ3B æ¨¡å‹å‹‰å¼ºä¸ 7B æ¨¡å‹è¿­ä»£ 200 æ­¥çš„æ•ˆæœæ¥è¿‘ã€‚

**3B é‡çº§æ¨¡å‹ä¸ 7B é‡çº§åˆå§‹å›å¤é•¿åº¦åŸºæœ¬æ¥è¿‘ï¼Œä½† 3B æ¨¡å‹æœ€ç»ˆè¾¾åˆ°çš„å›å¤é•¿åº¦å¤§äº 7B æ¨¡å‹**ã€‚è®­ç»ƒè¶³å¤Ÿé•¿æ—¶é—´ï¼ˆstep \> 200ï¼‰åï¼Œ3B æ¨¡å‹ç”Ÿæˆè§£é¢˜è¿‡ç¨‹æ—¶éœ€è¦ä¾é æ›´å¤šè¾“å‡º tokenã€‚è¿™ä¹Ÿåæ˜ äº†å°ºå¯¸æ›´å°çš„æ¨¡å‹ç”±äºæ¨ç†èƒ½åŠ›æœ‰é™ï¼Œå¾€å¾€éœ€è¦æ›´é•¿çš„æ€ç»´é“¾è¿‡ç¨‹è¡¨ç¤ºä¸­é—´è¿‡ç¨‹ã€‚

| è®­ç»ƒé›† | æµ‹è¯•é›† |
| --- | --- |
| ![Image 33: img](assets/4/e/4edf0ddfb3bc3277e43776f1529bafcb.png) | ![Image 34: img](assets/5/f/5fe143a02c0e7d7f76182cc50414adb1.png) |

å›¾ 3.2.4(2) TinyZero è®­ç»ƒè¿‡ç¨‹ä¸­è®­ç»ƒé›†ï¼ˆå·¦ï¼‰ä¸æµ‹è¯•é›†ï¼ˆå³ï¼‰ä¸Šæ€è€ƒä¸å›ç­”é•¿åº¦çš„å˜åŒ–

ä¸ºäº†åˆ†æåœ¨å‡ ä¸ªå…³é”®è½¬æŠ˜ç‚¹ä¸Šæ¨¡å‹çš„å…·ä½“è¾“å‡ºå†…å®¹ï¼Œæˆ‘ä»¬è¿˜é€‰å–äº†èµ·å§‹é˜¶æ®µï¼ˆstep=0ï¼Œå³ Base æ¨¡å‹ï¼‰ã€é•¿åº¦éª¤é™é˜¶æ®µï¼ˆstep=24ï¼‰ã€é•¿åº¦å›å‡é˜¶æ®µï¼ˆstep=72ï¼‰ã€å¹³å°æœŸé˜¶æ®µï¼ˆstep=120ï¼‰ã€ç¼“æ…¢ä¸‹é™é˜¶æ®µï¼ˆstep=300ï¼‰è¿™å‡ ä¸ªæ­¥éª¤çš„æ¨¡å‹ checkpointsï¼Œå¹¶åˆ†åˆ«æ¨ç†å¾—åˆ°äº†å¯¹åº”è®­ç»ƒé›†ã€æµ‹è¯•é›†çš„æ¨¡å‹è¾“å‡ºã€‚ä½¿ç”¨ã€ã€ã€å…³é”® token æŠ½å–äº†å¯¹åº”è¾“å‡ºä¸­çš„æ‰€æœ‰å†…å®¹è¿›è¡Œç»Ÿè®¡åˆ†æã€‚

**3B æ¨¡å‹ä¸ 7B æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„è¡¨ç°ç±»ä¼¼ï¼Œä½† 3B æ¨¡å‹æ¶ˆè€—äº†æ›´å¤šçš„æ€è€ƒ token**ã€‚è¿™ä¸€ç‚¹ä¸ä¸Šé¢æ•´ä½“å›å¤é•¿åº¦å˜åŒ–çš„ç»“æœä¸€è‡´ï¼Œå°å°ºå¯¸çš„æ¨¡å‹å¾€å¾€éœ€è¦æ›´å¤š CoT tokensã€‚

**æ¨¡å‹çš„è¾“å‡ºé•¿åº¦å˜åŒ–ä¸»è¦æ˜¯ç”± CoT çš„å˜åŒ–å¸¦æ¥çš„**ã€‚æ¨¡å‹è¾“å‡ºçš„ç­”æ¡ˆ tokens å‡ ä¹ä¸å˜ï¼ˆåœ¨ 8~16 tokens ä¹‹é—´ï¼‰ã€‚æ€ç»´é“¾çš„é•¿çŸ­æ˜¾è‘—å˜åŒ–ç›´æ¥å½±å“äº†æœ€ç»ˆè¾“å‡ºçš„é•¿åº¦å˜åŒ–ã€‚

**åœ¨ç›¸åŒéš¾åº¦ç±»å‹çš„ä»»åŠ¡ä¸‹æŒç»­è®­ç»ƒæ—¶ï¼Œéšç€æ¨¡å‹æ€§èƒ½çš„ä¸æ–­ä¸Šå‡ï¼Œæ¨¡å‹è§£é¢˜ CoT ä¸­çŠ¯é”™çš„æ­¥éª¤åœ¨å‡å°‘ï¼Œæ•´ä½“ CoT çš„é•¿åº¦åœ¨ç¼“æ…¢ä¸‹é™**ã€‚ä»¥ 7B æ¨¡å‹ä¸Šçš„è®­ç»ƒä¸ºä¾‹ï¼Œå½“æŠµè¾¾å¹³å°æœŸï¼ˆstep=120ï¼‰åï¼Œæ¨¡å‹çš„è¾“å‡ºé•¿åº¦ä¸æ–­åœ¨å˜çŸ­ï¼Œä¸€ç›´ç¼“æ…¢ä¸‹é™ï¼ˆstep=300ï¼‰ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™æ˜¯å› ä¸ºåœ¨ç›¸åŒéš¾åº¦çš„ä»»åŠ¡ï¼ˆcountdownï¼‰ä¸‹ï¼Œ7B æ¨¡å‹é€æ¸è¿‡æ‹Ÿåˆåˆ°è¯¥ä»»åŠ¡ä¸Šï¼ˆæµ‹è¯•é›†æ€§èƒ½ä¸æ–­ä¸Šå‡ï¼‰ã€‚å› æ­¤ï¼Œæ¨¡å‹é€æ¸æŒæ¡äº†æ­£ç¡®çš„æ€ç»´é“¾è€Œæå‡äº†æ¨ç†èƒ½åŠ›ï¼Œç›¸åº”åœ°å‡å°‘äº†é”™è¯¯çš„æ¨ç†é“¾ tokenã€‚å¦‚å›¾ 3.2.4(3)ï¼‰ä¸ºç¤ºæ„ï¼Œå½“è¿­ä»£æ­¥æ•°ä» step=24 å¼€å§‹é€’å¢æ—¶ï¼Œæ¨ç†é“¾è·¯å¼€å§‹è¾¹é•¿ï¼Œæ¨¡å‹åœ¨ Step=72 å±•ç°å‡ºå¤šç§è¡¨è¾¾å¼è®¡ç®—çš„æ¢ç´¢è·¯å¾„ã€‚åŒæ—¶ï¼Œåœ¨æ¯ä¸ªè¡¨è¾¾å¼è®¡ç®—å®Œæ¯•åï¼Œæ¨¡å‹ä¼šæ ¹æ®å½“å‰è®¡ç®—æŒ‡æ ‡ä¸ç›®æ ‡å€¼ä¹‹é—´çš„å·®å¼‚åæ€æ˜¯å¦æ»¡è¶³è¦æ±‚ï¼Œå¹¶åœ¨ä¸‹ä¸€æ¬¡æ¢ç´¢ä¸­é€æ­¥è°ƒæ•´ã€‚éšç€è¿›ä¸€æ­¥è®­ç»ƒï¼ˆstep=72 è‡³ step300ï¼‰ï¼Œæ¨¡å‹è¯•é”™çš„æ¬¡æ•°åœ¨å‡å°‘ï¼Œåªéœ€è‹¥å¹²æ¬¡å°è¯•å³è·å¾—äº†æ­£ç¡®ç­”æ¡ˆã€‚

![Image 35: img](assets/a/5/a5aa03cd0539f4931c603a9ba0d5e727.png)

img

å›¾ 3.2.4(3) TinyZero è®­ç»ƒè¿‡ç¨‹ä¸­æ¨¡å‹æ¨ç†é“¾å˜åŒ–

**Base æ¨¡å‹æœ¬èº«å³å±•ç°å‡ºäº†ç›¸å½“çš„æ¨ç†èƒ½åŠ›ï¼Œæ‹¥æœ‰æ€ç»´é“¾çš„åŸºç¡€ç»“æ„**ã€‚åœ¨ Step=0 æ—¶ç›´æ¥æ¨ç† Qwen2.5-7B-Base æ¨¡å‹ï¼Œæ¨¡å‹è¾“å‡ºçš„æ€ç»´é“¾ä¸­å·²ç»åŒ…å«äº†åˆ†æ­¥éª¤æ€è€ƒçš„å‡ ä¸ªæ ‡å¿—æ€§å…³é”®è¯ï¼ˆFirst, Next, Finallyï¼‰ã€‚æˆ‘ä»¬è®¤ä¸ºåƒé—®çš„é¢„è®­ç»ƒè¯­æ–™ä¸­åº”è¯¥ä¹Ÿå…·å¤‡å¤§é‡çš„å«æœ‰ branchingã€self-reflection ç­‰ç‰¹ç‚¹çš„æ•°æ®ã€‚è¿™æ„å‘³ç€æ¨¡å‹åœ¨é¢„è®­ç»ƒé˜¶æ®µå·²ç»æŒæ¡äº† long CoT çš„åŸºæœ¬ç»“æ„æ˜¯æ¿€å‘åæ€èƒ½åŠ›çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶ã€‚ä¸€ä¸ªå¯è¡Œçš„ç†è§£æ˜¯ï¼ŒRL æœ¬èº«æ›´å¤šåœ°æ˜¯æ¿€å‘æ­£ç¡®çš„æ€ç»´é“¾è¿‡ç¨‹ï¼Œæƒ©ç½šè‚¤æµ…çš„ã€é”™è¯¯çš„æ€ç»´æ–¹å¼ã€‚

ä¸ºäº†ç»Ÿè®¡æ¨¡å‹åœ¨ RL è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ¨ç†é“¾æ˜¯å¦å¾—åˆ°å¢å¼ºï¼Œéœ€åˆ†æï¼š1ï¼‰æ¨ç†é“¾æ˜¯å¦å‡ºç°äº†ç»“æ„åŒ–çš„åˆ†æ­¥è§£é¢˜ï¼Œå³ Reasoning èƒ½åŠ›ï¼›2ï¼‰æ¨ç†é“¾æ˜¯å¦è¡¨ç°å‡ºäº†åæ€ï¼Œå³ Self - Reflection èƒ½åŠ›ã€‚è¿™é‡Œä¾æ—§é‡‡ç”¨æ­£åˆ™è¡¨è¾¾å¼å»ç»Ÿè®¡æ€ç»´é“¾ä¸­ç›¸åº”å…³é”®è¯çš„é¢‘æ•°ã€‚

å¯¹äºå‰è€…ï¼ˆåˆ†æ­¥è§£é¢˜ï¼‰ï¼Œæˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹å…³é”®è¯ï¼š

```
-Â StepÂ 1,Â Step2,Â ...  
-Â 1.,Â 2.,Â ...  
-Â First,Â Second,Â Next,Â Finally  
```

å¯¹äºåè€…ï¼ˆåæ€ä¸æ¢ç´¢ï¼‰ï¼Œæˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹å…³é”®è¯ï¼š

```
rethink,Â recheck,Â tryÂ again,Â let'sÂ correctÂ itÂ andÂ verifyÂ theÂ stepsÂ again,Â recheck,Â reÂ -Â evaluate,Â checkÂ again,Â tryÂ again,Â let'sÂ tryÂ again,Â let'sÂ thinkÂ again,Â tooÂ high,Â tooÂ low,Â closeÂ but,Â tryÂ anotherÂ approach,Â tryÂ different  
```

| åˆ†æ­¥æ¨ç† | åæ€ |
| --- | --- |
| ![Image 36: img](assets/c/5/c596d771a4c75f40114662144ad9e8a7.png) | ![Image 37: img](assets/1/9/195348e4acc468db373233eb3913a1bf.png) |

å›¾ 3.2.4(4) TinyZero è®­ç»ƒè¿‡ç¨‹ä¸­æ¨¡å‹ CoT åˆ†æ­¥æ¨ç†ä¸åæ€ pattern å˜åŒ–

å¦‚ä¸Šè¿°å›¾ 3.2.4(4) æ‰€ç¤ºï¼Œæ— è®ºæ˜¯ 3B è¿˜æ˜¯ 7B çš„åƒé—® Base æ¨¡å‹åœ¨ step=0 æ—¶å°±å·²ç»å±•ç°å‡ºäº†ä¸€å®šçš„åˆ†æ­¥æ€è€ƒä»¥åŠåæ€èƒ½åŠ›ã€‚å› æ­¤ï¼Œç±» R1 çš„ RL è®­ç»ƒæ–¹å¼å¹¶ä¸æ˜¯ã€Œå‡­ç©ºåˆ›é€ ã€äº† LLM çš„ CoT èƒ½åŠ›ï¼Œè€Œæ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¼•å¯¼ LLM åå¥½æ­£ç¡®çš„ã€åˆé€‚çš„æ¨ç†é“¾è·¯ã€‚åœ¨è¿™æ ·çš„æ¨ç†é“¾è·¯ä¸­ï¼Œbranching/self - reflection ç­‰ç‰¹æ€§æ˜¯é€šè¿‡ reward function æ¥é¼“åŠ±ä¹ å¾—çš„ã€‚

**ç›¸æ¯”äºåˆ†æ­¥è§£é¢˜èƒ½åŠ›ï¼Œæ¨¡å‹çš„åæ€èƒ½åŠ›åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å‘ç”Ÿæ›´æ˜¾è‘—çš„å˜åŒ–**ã€‚åœ¨ Step=0 æ—¶ï¼ŒåŸºåº§æ¨¡å‹å°±å·²ç»å±•ç°å‡ºäº†æ¯”è¾ƒå¼ºçš„åˆ†æ­¥éª¤è§£é¢˜çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¯¹è¾“å…¥ prompt ä¸­ "think step by step" ç»™å‡ºè¾ƒå¥½çš„å“åº”ã€‚ä½†æ­¤æ—¶æ¨¡å‹å¹¶ä¸å…·å¤‡è¾ƒç‰¹åˆ«å¼ºçš„åæ€èƒ½åŠ›ï¼Œåšé”™çš„æ—¶å€™æ¨¡å‹å€¾å‘äºé‡å¤å‰åºçš„è§£æ³•è€Œä¸å»æ¢ç´¢æ–°çš„è§£æ³•ï¼ˆå¯èƒ½å—é™äºæŒ‡ä»¤ç†è§£èƒ½åŠ›ï¼‰ã€‚è™½ç„¶ä½¿ç”¨äº†åˆ†æ­¥æ€è€ƒï¼Œä½†å‡ºç°é”™è¯¯åçš„åæ€æ˜¯æ— æ•ˆçš„ï¼Œé™·å…¥äº†é‡å¤è¾“å‡ºçš„åå¡ŒçŠ¶æ€ï¼ˆå¦‚å›¾ 3.2.5(5) æ‰€ç¤ºï¼‰ã€‚è€Œä¸”ï¼Œæ­¤æ—¶æ¨¡å‹ä¼¼ä¹å¿˜è®°äº†æœ€ç»ˆçš„ç›®æ ‡æ˜¯åˆ©ç”¨è¿™ä¸‰ä¸ªæ•°å­—è®¡ç®—å¾—åˆ°ç›®æ ‡å€¼ï¼ˆ55ï¼‰ï¼Œæ¢ç´¢çš„è§£é¢˜æ­¥éª¤å±€é™åœ¨å‡‘æ»¡æŸä¸ªå­ç›®æ ‡å€¼ï¼ˆ19ï¼‰ä¸Šï¼Œ**æ— æ³•è·³å‡ºæ¬¡ä¼˜çš„è·¯å¾„**ã€‚

![Image 38: img](assets/5/2/52077b1d7d5793cf820457a05e61fc01.png)

img

å›¾ 3.2.4(5) TinyZero è®­ç»ƒè¿‡ç¨‹ä¸­ Step=0 æ—¶åŸºåº§æ¨¡å‹å±•ç°çš„æ— æ•ˆåæ€

éšç€è®­ç»ƒè¿‡ç¨‹çš„ç»§ç»­ï¼Œåº¦è¿‡è¾“å‡ºé•¿åº¦æœ€çŸ­ï¼ˆstep=24ï¼‰æ—¶åˆ»åï¼Œæ¨¡å‹é€æ¸å¼€å§‹å…·å¤‡çœŸæ­£çš„åæ€èƒ½åŠ›ã€‚ä»¥ step=72 æ—¶åˆ»ä¸ºä¾‹ï¼ˆå›¾ 3.2.4(6)ï¼‰ï¼Œæ¨¡å‹è¾“å‡ºçš„æ¨ç†é“¾è·¯ä¸­å‡ºç°äº†ã€ŒWait, I made a mistakeã€è¿™æ ·çš„æœ‰æ•ˆåæ€çŠ¶æ€ï¼Œé’ˆå¯¹ä¹‹å‰çš„é”™è¯¯å›ç­”è¿›è¡Œäº†æœ‰æ•ˆæ‰¹åˆ¤ï¼Œå¹¶ç»§ç»­æ¢ç´¢å¯èƒ½çš„è§£æ³•ï¼Œè¯¥ã€Œé«˜å…‰æ—¶åˆ»ã€é¢„ç¤ºç€æ¨¡å‹æ­£ç»å† aha momentã€‚

![Image 39: img](assets/d/9/d950cd23f0ef045e7b05270a43497097.png)

img

å›¾ 3.2.4(6) TinyZero è®­ç»ƒè¿‡ç¨‹é€’è¿›æ—¶åæ€èƒ½åŠ›çš„è¿›åŒ–

**GRPO ä¼˜åŒ–**

TinyZero é¡¹ç›®é»˜è®¤ä½¿ç”¨äº† PPO ä¼˜åŒ–ç®—æ³•ï¼Œæˆ‘ä»¬åŒæ—¶ä¹Ÿå°è¯•äº†æ›¿æ¢æˆ GRPO è¿›è¡Œè®­ç»ƒã€‚æ—¶é—´æœ‰é™ï¼Œæˆ‘ä»¬å¯¹äº GRPO çš„è¶…å‚æ²¡æœ‰åšè¿‡å¤šçš„è°ƒä¼˜ã€‚åœ¨ 8Â  GPUs çš„ç®—åŠ›ä¸‹è®¾ç½®äº† rollout æ•°é‡ä¸º 24ï¼Œå¹¶å‡å°‘ train batch size è‡³ 8 æ¥é¿å… OOM é—®é¢˜ã€‚æˆ‘ä»¬ä½¿ç”¨äº†é»˜è®¤çš„é‡‡æ ·æ¸©åº¦ç³»æ•°ï¼Œè®­ç»ƒäº†çº¦ 5epã€‚æ ¸å¿ƒçš„è®­ç»ƒæŒ‡æ ‡å¦‚ä¸‹å›¾ 3.2.4(7) æ‰€ç¤ºã€‚

**ç›¸æ¯”äº PPO è®­ç»ƒæ¥è¯´ï¼ŒGRPO çš„è®­ç»ƒæ›´åŠ ä¸ç¨³å®š**ã€‚è¿™ä¸€ç‚¹åœ¨å…¶ä»–çš„å¼€æºé¡¹ç›®å¤ç°æ—¶ä¹Ÿé‡åˆ°äº†ã€‚æ— è®ºæ˜¯åƒé—® 3B æ¨¡å‹è¿˜æ˜¯ 7B Base æ¨¡å‹ï¼ŒGRPO ç‰ˆæœ¬çš„ä¼˜åŒ–å‘ˆç°å‡ºæå¤§çš„ä¸ç¨³å®šæ€§ï¼Œè¾“å‡ºé•¿åº¦ä¸Šçš„å˜åŒ–å¹…åº¦æ¯”è¾ƒå¤§ã€‚åç»­ä¼˜åŒ–æ–¹å‘ï¼š1ï¼‰è¶…å‚çš„è®¾ç½®å¾—è¿›ä¸€æ­¥è°ƒä¼˜ï¼›2ï¼‰GRPO å¼ºä¾èµ–é‡‡æ · rollout çš„è´¨é‡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»å°½å¯èƒ½æé«˜ rollout çš„æ•°é‡æ¥ä¿è¯åŸºäºç»„ï¼ˆgroupï¼‰çš„ä¼˜åŠ¿ï¼ˆadvantageï¼‰ä¼°è®¡å‡†ç¡®ï¼Œä½†æ˜¯è¿™åˆä¼šé€ æˆå•æœºè®­ç»ƒæ—¶ OOM é—®é¢˜ã€‚åç»­ä¾èµ–ç¨³å¥çš„å¤šæœº RL æ¡†æ¶æ¥å¯¹è¶…å‚è¿›è¡Œç²¾è°ƒï¼Œå‡å°‘è®­ç»ƒä¸ç¨³å®šçš„é—®é¢˜ã€‚

| æµ‹è¯•é›†æŒ‡æ ‡ | å›å¤é•¿åº¦ |
| --- | --- |
| ![Image 40: img](assets/b/f/bfb0d985a9c678e690c95f29e4a58729.png) | ![Image 41: img](assets/2/3/233e2f1b1a41dc9c8dac09049ada889e.png) |

å›¾ 3.2.4(7) TinyZero (GRPO)è®­ç»ƒè¿‡ç¨‹ä¸­æµ‹è¯•é›†æŒ‡æ ‡ï¼ˆå·¦ï¼‰ä¸å›å¤é•¿åº¦ï¼ˆå³ï¼‰çš„å˜åŒ–

4\. æ€»ç»“
------

æˆ‘ä»¬ç›®å‰åŸºäº DeepSeek R1/R1-zero çš„å¤§é‡å¼€æºå·¥ä½œä»åŸç†ä¸Šå¤§è‡´è¿˜åŸäº† DeepSeek çš„è®­ç»ƒè¿‡ç¨‹ï¼Œä½†æ˜¯éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œè¿™äº›å°è¯•å¤§å¤šå±äº toy dataset éªŒè¯æ€§å®éªŒï¼Œç¦»çœŸæ­£çš„ R1 å¤ç°ä»æœ‰è¾ƒå¤§çš„å·®è·ã€‚æˆ‘ä»¬è®¤ä¸ºæœªæ¥çš„å·¥ä½œéœ€äºŸå¾…è§£å†³ï¼š

*   æ”¯æŒå¤§è§„æ¨¡ RL è®­ç»ƒï¼ˆPPOã€GRPO ç­‰ï¼‰çš„å¼€æºåŸºç¡€æ¡†æ¶
    
*   ç”¨äºç¨³å®šè®­ç»ƒçš„ GRPO è®­ç»ƒè¶…å‚çš„è‡ªåŠ¨åŒ–è°ƒä¼˜
    
*   RL è®­ç»ƒæ•°æ®çš„é…æ¯”ï¼ˆéš¾åº¦ã€é¢†åŸŸã€ä»»åŠ¡ç­‰ï¼‰
    
*   åŸºäº Instruct æ¨¡å‹è®­ç»ƒ R1 æ—¶ï¼Œé«˜è´¨é‡ long CoT çš„æ•°æ®è·å–
    
*   åˆé€‚çš„æƒ©ç½šå‡½æ•°è®¾è®¡ä»¥ä¿è¯ CoT æ€è€ƒé“¾è´¨é‡ä¸é€€åŒ–
    

åº”ç”¨åœ¨ä¸šåŠ¡è½åœ°æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ï¼š

1ï¼‰æ¨¡å‹åœ¨ç»™å®šçš„ prompt ä¸‹ï¼Œç»“åˆé¢„è®­ç»ƒçš„åŸºæœ¬çŸ¥è¯†èƒ½å¦æ­£ç¡®ç»™å‡ºæ­£ç¡®çš„æ¨ç†ç»“æœã€‚ä»»ä½•ä¸šåŠ¡ä¸­çš„ã€Œæ½œè§„åˆ™ã€éƒ½éœ€è¦æ˜¾å¼åœ°å®šä¹‰åœ¨ prompt ä¸­ï¼Œå¹¶å°½å¯èƒ½é¿å…ä¸é¢„è®­ç»ƒçŸ¥è¯†çš„å†²çªã€‚

2ï¼‰æ··åˆé€šç”¨æ•°æ®ã€ä¸šåŠ¡æ•°æ®ä¸æ•°å­¦ã€ä»£ç ç±»é¢†åŸŸä»»åŠ¡ä¸‹çš„ long CoT SFT æ•°æ®æ¥ç»™æ¨¡å‹å…ˆæ‰“ä¸‹ä¸€ä¸ªåšå®çš„æ€ç»´é“¾èŒƒå¼åŸºç¡€ï¼Œè¿™æœ‰åˆ©äºæå‡ RL è®­ç»ƒæ—¶çš„ç¨³å®šæ€§ã€‚

å¸Œæœ›æ›´å¤šå¼€æºç¤¾åŒºå·¥ä½œçš„å‘å¸ƒèƒ½å¤Ÿä¿ƒä½¿é•¿æ€è€ƒæ¨¡å‹æ¨ç†èƒ½åŠ›è¿›ä¸€æ­¥æå‡ã€‚

5\. å…¬å¼€å‚è€ƒèµ„æ–™
----------

*   [simpleRL-reason](https://github.com/hkust-nlp/simpleRL-reason)ï¼šGitHub - hkust - nlp/simpleRL - reason: This is a replicate of DeepSeek - R1 - Zero and DeepSeek - R1 training on small models with limited data
    
*   [open-r1](https://github.com/huggingface/open-r1)ï¼šGitHub - huggingface/open - r1: Fully open reproduction of DeepSeek - R1
    
*   \[logit - RL\](https://github.com/Unakar/Logic - RL)ï¼šGitHub - Unakar/Logic - RL: Reproduce R1 Zero on Logic Puzzle
    
*   \[tinyzero\](https://github.com/Jiayi - Pan/TinyZero)ï¼šGitHub - Jiayi - Pan/TinyZero: Clean, minimal, accessible reproduction of DeepSeek R1 - Zero
    
*   \[demystify long CoT\](https://github.com/eddycmu/demystify - long - cot)ï¼šGitHub - eddycmu/demystify - long - cot
    
*   [deepscaleR](https://www.notion.so/)ï¼šNotion â€“ The all - in - one workspace for your notes, tasks, wikis, and databases.
